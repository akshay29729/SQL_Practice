var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},__spreadArrays,BingAtWork;(function(n){function y(n,t){var i={},r=n.flights,u;r&&r.length>0&&(i.variants=r.join());for(u in t)i[u]=t[u];return i}function p(n,t){var i,r;if(t)for(i in t)r=n.indexOf("?")>-1?"&":"?",n+=""+r+encodeURIComponent(i)+"="+encodeURIComponent(t[i]);return n}function w(n){var t=7;switch(n){case 500:t=6;break;case 404:t=9;break;case 401:t=4;break;case 504:t=5;break;case 400:t=8}return t}function b(n){for(var r,t,f,u=[],i=1;i<arguments.length;i++)u[i-1]=arguments[i];if(!n)return n;for(r=n,t=0;t<u.length;t++)f=new RegExp("\\{"+t+"\\}","gm"),r=r.replace(f,arguments[t+1]);return r}function k(t,i){try{return JSON.parse(t)}catch(r){return null}}function d(n,t,i){var r,u;for(i===void 0&&(i=7),r=n,u=0;r&&u<i;u++){if(r===t)return!0;r=r.parentElement}return!1}function g(n){n!=null&&n.parentNode!=null&&n.parentNode.removeChild(n)}function r(n,t,i,u,f){u===void 0&&(u=0);n()||(t>1?setTimeout(function(){return r(n,t-1,i,u,f)},i+u):f&&f())}function u(n){if(typeof bfbTel!="undefined"&&bfbTel){n();return}sj_evt.bind("bfbWebTelemetryExists",n,!1,null,!0)}function nt(t){if(typeof n.Strings!="undefined"&&n.Strings){t();return}sj_evt.bind("BingAtWork:LocStrings",t,!0,null,!0)}function i(){return!!("localStorage"in _w&&_w.localStorage)}function ut(t,r,u,s,c,l){var a,p,y,b;if(!i()||!ft())return r({onSuccess:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onSuccess.apply(u,t);s.onSuccess.apply(s,t)},onError:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onError.apply(u,t);s.onError.apply(s,t)}});if(n._isEventBind||(n._isEventBind=!0,sj_evt.bind("ajax.unload",function(){n._localStorageAutoRefreshHandlersBacklog={};n._localStorageOneOffHandlersBacklog={}},!0,null,!0)),n._localStoragePendingAutoRefreshes=n._localStoragePendingAutoRefreshes||{},n._localStorageAutoRefreshHandlersBacklog=n._localStorageAutoRefreshHandlersBacklog||{},n._localStorageOneOffHandlersBacklog=n._localStorageOneOffHandlersBacklog||{},n._localStorageAutoRefreshHandlersBacklog[t]&&n._localStorageAutoRefreshHandlersBacklog[t].length>0){n._localStorageAutoRefreshHandlersBacklog[t].push(u);return}if(n._localStorageAutoRefreshHandlersBacklog[t]=[u],n._localStorageOneOffHandlersBacklog[t]&&n._localStorageOneOffHandlersBacklog[t].length>0){n._localStorageOneOffHandlersBacklog[t].push(s);return}if(n._localStorageOneOffHandlersBacklog[t]=[s],a=e(t),p=at(a),p){var w=p.split(";",2),k=w[0],d=w[1],v=Number(k);if(!v||v===NaN||v<(new Date).getTime())h(a);else{y=void 0;try{y=JSON.parse(d)}catch(g){h(a)}if(y!=null){o(t,y,new Date(v),!0,l,r,c,!0);return}}}b=f(t,c,l,r);r(b)}function ft(){return n.context&&n.context.isLSCacheEnabled}function f(i,r,u,f){var s=e(i);return{onSuccess:function(n){var t=r(n);o(i,n,t,!1,u,f,r);setTimeout(function(){return lt(s,t.getTime()+";"+JSON.stringify(n))},0)},onError:function(){for(var f=[],r=0;r<arguments.length;r++)f[r]=arguments[r];t(n._localStorageAutoRefreshHandlersBacklog[i],function(n){n.onError&&n.onError.apply(n,f)});t(n._localStorageOneOffHandlersBacklog[i],function(n){n.onError&&n.onError.apply(n,f)});u||(n._localStorageAutoRefreshHandlersBacklog[i]=[]);n._localStorageOneOffHandlersBacklog[i]=[]}}}function e(n){return""+tt+n}function o(i,r,u,e,o,s,h,c){if(t(n._localStorageAutoRefreshHandlersBacklog[i],function(n){n.onSuccess(r,undefined,c)}),o||(n._localStorageAutoRefreshHandlersBacklog[i]=[]),t(n._localStorageOneOffHandlersBacklog[i],function(n){n.onSuccess(r,undefined,c)}),n._localStorageOneOffHandlersBacklog[i]=[],o&&!n._localStoragePendingAutoRefreshes[i]){var l=Math.max(u.getTime()-(new Date).getTime()+it,e?rt:0);n._localStoragePendingAutoRefreshes[i]=!0;setTimeout(function(){var t=f(i,h,o,s);s(t);n._localStoragePendingAutoRefreshes[i]=!1},l)}}function et(t,i){var r,u;return((u=(r=n.SessionStorage)===null||r===void 0?void 0:r.isSupported)===null||u===void 0?void 0:u.call(r))?ot(n.SessionStorage.getItem(t),i):undefined}function ot(n,t){if(!n)return undefined;var r=n.split(";",2),u=r[0],f=r[1],i=Number(u);return!i||i===NaN||i<=(new Date).getTime()-t?undefined:f}function st(t,i){var r,u;((u=(r=n.SessionStorage)===null||r===void 0?void 0:r.isSupported)===null||u===void 0?void 0:u.call(r))&&n.SessionStorage.setItem(t,(new Date).getTime()+";"+i)}function t(n,t){if(n)for(var i=0;i<n.length;i++)t(n[i])}function ht(n,t){if(!n)return!1;for(var i=0;i<n.length;i++)if(n[i]===t)return!0;return!1}function s(){var n=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}function ct(n){var t;return typeof Event=="function"?t=new Event(n):(t=document.createEvent("Event"),t.initEvent(n,!0,!0)),t}function lt(n,t){if(i())try{localStorage.setItem(n,t)}catch(r){}}function at(n){if(i())try{var t=localStorage.getItem(n);return t===null?undefined:t}catch(r){}return undefined}function h(n){if(i())try{localStorage.removeItem(n)}catch(t){}}function c(t){var l=t.condition,a=t.maxAttempts,f=t.baseIntervalInMillis,r=t.logName,o=t.callback,e=t.additionalIntervalPerAttemptInMillis,i=t.currentAttempt,s=t.timeOutCallback,h;e=e||0;i=i||0;l()?o!=null&&o():(i++,i<a?(h=__assign(__assign({},t),{baseIntervalInMillis:f+e,currentAttempt:i}),setTimeout(function(){return c(h)},f)):(u(function(){return bfbTel.logDiag(r+"_TimedOut")}),s!=null&&s()))}function vt(t,i,r,u,f){for(var h,a,y,w,v=[],c=5;c<arguments.length;c++)v[c-5]=arguments[c];h=new Date;n._throttleRecords||(n._throttleRecords={});a=f.id;a||(a=f.id=s());try{y=JSON.stringify(r)}catch(b){return}var p=f.name||"(anonymous)",o=p+"_"+a+"_"+y,e=n._throttleRecords[o];if(e){if(e.totalCalls++,e.clusterCalls++,e.clusterCalls>t)if(w=h.getTime()-e.lastRunTime.getTime(),w>=i)e.clusterCalls=1,e.clusters++;else return e.throttledCalls++,e.lastThrottledCallStack=l("Call throttled"),u(),undefined}else n._throttleRecords[o]={totalCalls:1,clusterCalls:1,allowedCalls:0,throttledCalls:0,firstRunTime:h,lastRunTime:h,clusters:1,name:p};return n._throttleRecords[o].allowedCalls++,n._throttleRecords[o].lastRunTime=h,f.apply(void 0,v)}function l(n){return a(new Error(n).stack)}function a(n){return n&&n.replace(/\?.*/gi,"?<query string redacted>")}function yt(i){if(i===void 0&&(i=!0),!n._throttleRecords)return undefined;var r=[],u=Object.keys(n._throttleRecords);return t(u,function(t){var u=n._throttleRecords[t];(!i||u.throttledCalls>0)&&r.push(u)}),r}function pt(){n._throttleRecords={}}function wt(n,t){if(!n)return undefined;for(var i=0;i<n.length;i++)if(t(n[i]))return n[i];return undefined}function bt(n){return n&&n.length==0}function kt(n){var i=v(n),t;return i?(t=i.slice(0,4),t=="<svg"||t=="<?xm"):!1}function v(t){try{return atob(t)}catch(i){}}function dt(t){typeof n.Localhost!="undefined"&&typeof n.Localhost.augmentMsbMtAjax=="function"&&n.Localhost.augmentMsbMtAjax(t)}function gt(n){if(!n.isOnWorkVertical)return undefined;var t=(window.location.hash||"").replace("#",""),i=t.indexOf("-");return t.substring(0,i>-1?i:t.length).toLocaleLowerCase()||"all"}n.bawSourceName="BingAtWork";n.msPerDay=864e5;n.getRequestMetadata=y;n.mergeArgsIntoUrl=p;n.getError=w;n.strFormat=b;n.tryParseJson=k;n.hasAncestorElement=d;n.removeElement=g;n.retryPoll=r;n.whenWebTelemetryExists=u;n.whenLocStringsAvailable=nt;n.isLocalStorageSupported=i;var tt="MSBLS_",it=18e4,rt=3e4;n.withLocalStorageCache=ut;n.getSessionStorage=et;n.writeSessionStorage=st;n.forEach=t;n.includes=ht;n.generateGuid=s;n.createNewEvent=ct;n.poll=c;n.throttle=vt;n.getSanitizedCallStack=l;n.redactQueryStrings=a;n.getThrottleRecords=yt;n.resetThrottleRecords=pt;n.find=wt;n.isEmpty=bt;n.isImageLikelySvg=kt;n.decodeBase64=v;n.augmentMsbMtAjax=dt;n.getStartedEventDetails=function(){return{startTime:new Date,startTimeStartDuration:performance.now()}};n.getSucceededEventDetails=function(n,t,i){return{endTime:new Date,endTimeStartDuration:performance.now(),response:n,headers:t,status:200,isFromCache:i}};n.getFailedEventDetails=function(n,t){return{endTime:new Date,endTimeStartDuration:performance.now(),error:n,status:t}};n.getLoweredWorkSerpVerticalDomain=gt})(BingAtWork||(BingAtWork={})),function(n){function i(n,t){if(t===void 0&&(t=0),n==null)throw new Error("arg "+t+" is null");return n}function o(t,i){try{var r=t();return typeof r=="undefined"||r===null?i:r}catch(u){return i}}function t(n){var t=new RegExp("^\\s*$");return n==null||t.test(n)}function s(n,t){var r=i(n).toLowerCase(),u=i(t,1).toLowerCase();return r.indexOf(u)>=0}function h(t,i){var f,r;return t==null?null:i?(r=u(t.ScopeAnalysis),{UserInfo:t.UserInfo,Items:r!=null&&r.QasIndexItems!=null&&r.QasIndexItems.length>0?JSON.parse(r.QasIndexItems[0].Metadata):null}):(f=n.getCommandItemGroups(t),f!=null?f[0]:null)}function u(n){return n==null||n.length===0?null:n[0]}function c(n,t){return{onSuccess:n,onError:t.onError}}function l(n){return n.length>1?n[1]:null}function a(n){var t=new Date;return t.setTime(t.getTime()+n*6e4),t}function f(i){if(i=e(i),t(i))return"";var r=n.getParameterByName("ue",i),u=t(r)?n.getParameterByName("q",i):r;return t(u)?"":u.trim()}function v(n){var i=f(n),u;return t(i)?"":(u=r(i.replace(/[<>\(\)\'\"]+/gi,"")),t(u))?"":r(i)}function y(i){if(i=e(i),t(i))return"";var r=n.getParameterByName("form",i);return r==null?null:r.trim()}function r(n){return n.replace(/^[\`\!\@\#\$\%\^\&\*\)\_\+\=\-\,\.\/\;\:\[\]\\\{\}\|\~\?\¿]+/gi,"").replace(/[\`\!\@\#\$\%\^\&\*\(\_\+\=\-\,\.\/\;\:\[\]\\\{\}\|\~\?\¿]+$/gi,"").replace(/('s )/gi," ").replace(/[ ]+/gi," ").toLowerCase()}function e(n){return t(n)?_w.location.href:n}function p(n){return n==null?"":_G!=null&&_G.Mkt!=null?n.toLocaleString(_G.Mkt).replace(/\.00$/,""):n.toString()}function w(n,t){return n==null||n.ScopeAnalysis==null||n.ScopeAnalysis.length<1?!1:t==null||t.length<1?!1:n.ScopeAnalysis.some(function(n){return t.indexOf(n.Domain)>-1})}function b(t,i){var r=n.isLocalStorageSupported()?localStorage.getItem(n.LocalStorageEnums.pinned.key):null,u=r==null?i:r===n.LocalStorageEnums.pinned["true"];return(t&&u)===!0}function k(n,t,i){t===void 0&&(t="jpeg");i===void 0&&(i=!0);var r="data:image/"+t+";base64,"+n;return i&&r?"url("+r+")":r}function d(n,t){var i=t[n];return i==null?undefined:t[i]}function g(t){var i=n.getMFASignInUrl(t);i!=null&&window.location.replace(i)}n.chk=i;n.safeGet=o;n.nullOrWs=t;n.containIgnoreCase=s;n.getResp=h;n.getFirstScopeAnalysis=u;n.cpyErr=c;n.secondOrNull=l;n.getDateAddMinutes=a;n.getRawQuery=f;n.getNormalizedQuery=v;n.getFormCodeFromUrl=y;n.normalizeQuery=r;n.localizeNumber=p;n.hasDomain=w;n.isPinned=b;n.imgSrc=k;n.enumPropertyToValue=d;n.redirectToMFASignIn=g}(BingAtWork||(BingAtWork={})),function(n){function e(){return"/orgid/simplesignout"}function o(n,t,i,r){var u="/business/search?q="+encodeURIComponent(n)+"&ue="+encodeURIComponent(t);return r!=null&&(u+="&bfbqi="+r),i!=null&&(u+="&FORM="+encodeURIComponent(i)),u}function s(t,i,r){return"/business/search?q="+encodeURIComponent(t)+"&bfbqi="+n.QueryIntent.Group+"&bfbgid="+encodeURIComponent(i)+"&FORM="+encodeURIComponent(r)}function h(t){return"/business/search?q=building%20"+encodeURIComponent(t)+"&ue=&bfbqi="+n.QueryIntent.Building+"&FORM=BAWBMD"}function c(t,i,r){return n.strFormat(t,encodeURIComponent(i),encodeURIComponent(r||""))}function l(t,i,r,u){return n.strFormat(t,encodeURIComponent(i),encodeURIComponent(r),encodeURIComponent(u||""))}function a(n,t){var i="/business/search?q="+encodeURIComponent(n);return t!=null&&(i+="&FORM="+encodeURIComponent(t)),i}function v(n,t){return"/business/mtr/iras?e="+n+"&c="+t}function y(r){var u=window.location.href,h=t("login_hint",u)||"",c=t("domain_hint",u)||"",l=t("redir",u),e=(Number(l)||1)+1,a=t("mfaredir",u),o=(Number(a)||1)+1,s;if(!(e>6)&&!(o>2))return u=f("itrid",u),u=i("redir",""+e,u),u=i("mfaredir",""+o,u),s=encodeURIComponent(u),n.strFormat(r,s,h,c,!0)}function u(n){var t=n.replace(/\+/g," ");return decodeURIComponent(t)}function t(n,t){var i=n.toLowerCase(),u=r(t);return u[i]}function i(t,i,u){var e=t.toLowerCase(),o=u.substring(0,u.indexOf("?")),f=r(u);return f[e]=i,n.mergeArgsIntoUrl(o,f)}function f(t,i){var f=t.toLowerCase(),e=i.substring(0,i.indexOf("?")),u=r(i);return delete u[f],n.mergeArgsIntoUrl(e,u)}function p(t){if(n.nullOrWs(t))return"";var i=new RegExp(/(\D*x).*$/ig),r=new RegExp(/\D/g);return"tel:+"+t.replace(i,"").replace(r,"")}function w(n){return"mailto:"+n}function b(n,t,i,r){return t&&!r?i?"ms-sfb://start":"ms-sfb://chat?id="+n:"sip:"+n}function k(){return"/business/uid"}function r(n){var i=n.substring(n.indexOf("?")+1),t={};return i.split("&").forEach(function(n){var i=n.split("=");i!=null&&i[0]!=null&&i[1]!=null&&(t[i[0].toLowerCase()]=u(i[1]))}),t}n.getSignOutUrl=e;n.getUserUrl=o;n.getGroupUrl=s;n.getBuildingMapUrl=h;n.getRoomInfoUrl=c;n.getFloorPlanUrl=l;n.getWorkSearchUrl=a;n.getMtrUrl=v;n.getMFASignInUrl=y;n.decodeQuery=u;n.getParameterByName=t;n.updateParameterByName=i;n.deleteParameterByName=f;n.getPhoneNumberUrl=p;n.getEmailUrl=w;n.getMessengerUrl=b;n.getFetchUidUrl=k}(BingAtWork||(BingAtWork={}));__spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},function(n){function r(t){n.writeSessionStorage("BingAtWorkConversationId",t)}var i=function(){function i(){this.signoutEvtHandlerAdded=!1;this.signoutRetentionNotification="SignoutRetention";this.uidRequestSent=!1;this.dwell={};this.dwellOnUnload=this.dwellOnUnload.bind(this)}return i.init=function(n){typeof bfbTel!="undefined"&&bfbTel.initialized||n!=null&&!n.isMtr&&n.cfg!=null&&n.cfg.e&&n.cfg.env!=="TEST"&&(bfbTel.setContext(n),bfbTel.regLogPagePerf(),bfbTel.regTenantSettingsUpdate(),sj_evt.fire("bfbWebTelemetryInitReady"))},i.prototype.setContext=function(i){var r=this,u,e,f;this.ctx=i;this.initialized||(this.initialized=!0,this.ariaLogger=AriaTelemetry.getLogger(i.cfg.t),n.context&&(this.logicalId=n.context.logicalId),sj_evt.bind("beforeunload",function(){return r.ariaLogger.flushAndTeardown()}),sj_evt.bind("ajax.load",function(){r.logicalId===n.context.logicalId?(r.logicalId=n.generateGuid(),n.context&&(n.context.logicalId=r.logicalId)):r.logicalId=n.context.logicalId}));u=this.ctx.isHomepage;sj_evt.bind("bfbWebTelemetryInitReady",function(){var i={};i.alreadySignedIn=n.context&&!!n.context.isAadAuthenticatedAtServer;i.ssoSignedIn=n.context&&!!n.context.isAadAuthenticatedBySSO;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",i)},!0,null,!0);sj_evt.bind("aad:signedin",function(i){var e,f={},o=(e=i[1])===null||e===void 0?void 0:e.userObjectId;n.context&&(f.alreadySignedIn=!!n.context.isAadAuthenticatedAtServer,n.context.isAadAuthenticatedBySSO=r.lastSSOAttempt!==null,f.ssoSignedIn=n.context.isAadAuthenticatedBySSO);o&&(r.ctx.uid=o,n.context&&(n.context.aadUserId=o));f.latency=r.lastSSOAttempt!==null?(performance.now()-r.lastSSOAttempt).toFixed(2):"-1";r.lastSSOAttempt=null;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",f)},!0,null,!0);sj_evt.bind("aad:signedout",function(){var i={};n.context&&(n.context.isAadAuthenticatedBySSO=!1);i.latency=r.lastSSOAttempt!==null?(performance.now()-r.lastSSOAttempt).toFixed(2):"-1";r.lastSSOAttempt=null;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"SsoError_Events",i)},!0,null,!0);sj_evt.bind("aad:ssoattempt",function(){r.lastSSOAttempt=performance.now()},!0,null,!0);sj_evt.bind("msb:warmupsucceeded",function(){var n={};n.latency=r.lastMsbWarmUpAttempt!==null?(performance.now()-r.lastMsbWarmUpAttempt).toFixed(2):"-1";n.success="1";r.lastMsbWarmUpAttempt=null;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"MsbWarmup_Events",n)},!0,null,!0);sj_evt.bind("msb:warmupfailed",function(){var n={};n.latency=r.lastMsbWarmUpAttempt!==null?(performance.now()-r.lastMsbWarmUpAttempt).toFixed(2):"-1";n.success="0";r.lastMsbWarmUpAttempt=null;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"MsbWarmup_Events",n)},!0,null,!0);sj_evt.bind("msb:warmupattempt",function(){r.lastMsbWarmUpAttempt=performance.now()},!0,null,!0);sj_evt.bind("ajax.unload",function(){r.dwellOnUnload("A")});_w.addEventListener("beforeunload",function(){r.dwellOnUnload("W")});e=function(){r.logSignout(u?t.BingAtWorkHomepage:t.BingAtWork)};f=function(){n.poll({condition:function(){var t=_ge("postLink");return!r.signoutEvtHandlerAdded&&t&&(sj_be(t,"click",e),r.signoutEvtHandlerAdded=!0),r.signoutEvtHandlerAdded},maxAttempts:50,baseIntervalInMillis:100,logName:"SignoutButton:polling"})};sj_be(_ge("id_n"),"click",f);sj_be(_ge("id_p"),"click",f);sj_evt.bind("Identity.SignoutNotifShown",function(){r.logShown(n.EventScope.UserNotification,0,null,{eventId:"Notification_Impression",notificationKind:r.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifSignoutClick",function(){r.logClicked(n.EventScope.UserNotification,!1,null,null,{eventId:"Notification_Dismiss_Click",notificationKind:r.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifBackgroundClick",function(){r.logClicked(n.EventScope.UserNotification,!1,null,null,{eventId:"Notification_Hide_BackgroundClick",notificationKind:r.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifCancelClick",function(){r.logClicked(n.EventScope.UserNotification,!1,null,null,{eventId:"Notification_Engagement_Click",notificationKind:r.signoutRetentionNotification})})},i.prototype.logShown=function(n,t,i,r){var u,f;t!=null&&(r=r||{},r.T=String(t));i!=null&&(r=r||{},r.S=i);f=(u=this.ctx)===null||u===void 0?void 0:u.canvas;f!=null&&(r=r||{},r.canvas=f);this.log(n,"Shown_Events",r)},i.prototype.logRanking=function(n,i,r,u){var f=n||{placement:null,treatment:null,rankingRuleId:null,legend:null},e=f.placement,o=f.treatment,s=f.rankingRuleId,h=f.legend,c={P:e,T:o,R:s,L:h,MTHD:i,AUD:r==null?null:r?1:0,ERR:u?"UNEXPCTRL":null};this.log(t.BingAtWork,"Ranking_Events",c)},i.prototype.logQuery=function(n,i){var r;if(n){var u=n.encryptedQuery,f=n.queryCount,e=n.queryFrequency,o=n.bhvr,s=n.webIntentConf,h=n.ssp,c=n.intent,l=n.groupId;r={QRY:u,CNT:f,FRQ:e,BHVR:o,CONF:s,SSP:h,INT:c,GID:l}}else r={NWK:1,QID:i};this.log(t.BingAtWork,"Query_Events",r)},i.prototype.logClicked=function(n,r,u,f,e){var o,s,h;u!=null&&(e=e||{},e.T=u);f!=null&&(e=e||{},e.S=f);s=(o=this.ctx)===null||o===void 0?void 0:o.canvas;s!=null&&(e=e||{},e.canvas=s);this.log(n,"Clicked_Events",e);this.ctx&&this.ctx.sci&&(r?this.sendExternalClickRateInst():this.inst(i.instClickEventType,"BfbClick",{BFB_EXT:r?"1":"0",BFB_T:u,BFB_S:f,BFB_SC:t[n]}));h={scope:n,target:u,source:f,properties:e};sj_evt.fire("BingAtWork:Click",h)},i.prototype.logValue=function(n,t,i,r){r=r||{};r.N=t;r.V=i;this.log(n,"Value_Events",r)},i.prototype.logSignout=function(n,t,i,r){var u,f;this.logClicked(n,!1,t,i,r);((u=this.ctx)===null||u===void 0?void 0:u.canvas)&&(r=r||{},r.canvas=(f=this.ctx)===null||f===void 0?void 0:f.canvas);this.log(n,"SignedOut_Events",r)},i.prototype.logRtt=function(n,t,i,r){var u=this.getRequestRtt(i,r);if(!(u.getCall<0)&&!(u.startCall<0)){var f=u==null?"NOPERF":u.getCall.toFixed(2),e=u==null?"NOPERF":u.startCall.toFixed(2),o={N:t,V:f,ST:e};this.log(n,"Rtt_Events",o)}},i.prototype.logSerpLinkClick=function(n,i){var r={T:"SERP",DOM:n,SERPID:i};this.log(t.Serp,"Clicked_Events",r)},i.prototype.logDiag=function(n,i){i=i||{};i.MSG=n;this.log(t.Diag,"Diag_Events",i)},i.prototype.regLogPagePerf=function(){var i=this,t;performance!=null&&performance.getEntries!=null&&(t=function(){i.logPagePerf();sj_evt.unbind("onP1",t)},sj_evt.bind("onP1",t,!0,0,!1))},i.prototype.logPagePerf=function(){for(var n,f,e,r=0,u=performance.getEntries();r<u.length;r++){n=u[r];for(f in i.pagePerfMatchConfig)i.pagePerfMatchConfig[f](n)&&(e={N:f,P:n.name,ET:n.entryType,IT:n.initiatorType,FETCH_S:n.fetchStart,REQ_S:n.requestStart,RES_S:n.responseStart,RES_E:n.responseEnd,D:n.duration,TSZ:n.transferSize},this.log(t.BingAtWork,"Perf_Events",e))}},i.prototype.log=function(t,i,r,u){var f=this;this.ariaLogger!=null&&(r=r||{},!this.ctx.uid&&(n.context===null||n.context===void 0?void 0:n.context.authorized)?(this.uidRequestSent||(this.uidRequestSent=!0,n.sendAjax({url:n.getFetchUidUrl(),onSuccess:function(t){f.ctx.uid=t&&t.uid;f.uidRequestSent=!1},onError:function(t,i){f.uidRequestSent=!1}})),n.poll({condition:function(){return f.ctx.uid!=null},maxAttempts:50,baseIntervalInMillis:50,logName:"WebTelemetry.log:polling",callback:function(){return f.logInternal(t,i,r,u)},timeOutCallback:function(){return f.logInternal(t,i,r,u)}})):this.logInternal(t,i,r,u))},i.prototype.logInternal=function(i,r,u,f){var e={eventType:"Client_Events",name:r||"",properties:{}},o,s,h,c;if(f||this.fillContextualKV(i,u),u!=null)for(o=0,s=Object.getOwnPropertyNames(u);o<s.length;o++)h=s[o],c=u[h],e.properties[h]={value:c!=null?c:""};this.ariaLogger.logEvent(e)},i.prototype.fillContextualKV=function(t,i){var r=this.ctx,e=r.cfg,o=r.uid,s=r.ig,h=r.tid,c=r.sid,l=r.muid,a=r.tn,v=r.tnid,y=r.msa,p=r.mkt,w=r.b,b=r.dev,k=r.os,d=r.osver,g=r.dc,nt=r.snrVersion,f=typeof _G=="undefined"?{IG:s,EventID:h}:_G,u=n.context,tt=u&&u.formCode||"";i.ENV=e.env;i.SC=t;i.IG=f.IG;i.SID=c;i.TID=f.EventID;i.UID=o;i.MUID=l;i.F=tt;i.TN=a;i.TNID=v;i.MSA=y;i.MKT=p;i.B=w;i.deviceType=b;i["DeviceInfo.OsName"]=k;i["DeviceInfo.OsVersion"]=d;i.dataCenter=g;i.clientType="Bing";i.snrVersion=nt;i.logicalSearchId=u&&u.logicalId;i.conversationId=u&&u.conversationId},i.prototype.getRequestRtt=function(t,i){var e=this,f,u,r;return performance==null||performance.getEntries==null?null:(f=performance.getEntries(),u=f.filter(function(r){if(r.name==null)return!1;var u=function(t){var i=r.name.toLowerCase(),u=e.getPathName(i)==="/search";return!u&&n.hasSub(i,t)};return t.every(u)&&(i==null||!i.some(u))}),u.length<1)?{getCall:-1,startCall:-1}:(r=u[0],{getCall:r.duration,startCall:r.fetchStart||r.startTime})},i.prototype.getPathName=function(n){var t=document.createElement("a");return t.href=n,t.pathname},i.prototype.sendExternalClickRateInst=function(){if(typeof _w.si_ct=="function"){var n=_ge("bfb_ExternalLink")||_ge("bfb_InstrumentationLink");n&&_w.si_ct(n)}},i.prototype.instCommand=function(n){this.inst(i.instEventType,"BfbCommand",n)},i.prototype.instAnswerExpansion=function(n){this.inst(i.instEventType,"BfbAnswerExpanded",{V:"1",P:n})},i.prototype.instGleam=function(n){this.inst(i.instEventType,"BfbGleam",{N:n})},i.prototype.instPLT=function(n){this.inst(i.instEventType,"BawPLT",{V:n})},i.prototype.inst=function(t,r,u){for(var o,f=[],e=0,s=Object.getOwnPropertyNames(u);e<s.length;e++)o=s[e],f.push(o),f.push(u[o]||"");Log.Log.apply(Log,__spreadArrays([t,r,i.instEventName,!1],f))},i.prototype.dwellStart=function(i,r){var u=this,f;f={DW_S:Date.now(),S:r};n.poll({condition:function(){return u.ctx!=null},maxAttempts:50,baseIntervalInMillis:50,logName:"WebTelemetry.dwellStart:polling",callback:function(){u.fillContextualKV(i,f);u.dwell[i]=f}})},i.prototype.dwellEnd=function(i){this.logDwell(i);try{delete this.dwell[i]}catch(r){this.dwell[i]=null}},i.prototype.logDwell=function(n,t){var i=this.dwell[n];if(i&&i.DW_S){var u=i.DW_S,r=Date.now(),f=r-u;i.N="DWELL";i.V=f;i.DW_E=r;i.DW_UL=t;this.log(n,"Value_Events",i,!0)}},i.prototype.dwellOnUnload=function(n){for(var i,t=0,r=Object.getOwnPropertyNames(this.dwell);t<r.length;t++)i=r[t],this.dwell.hasOwnProperty(i)&&this.dwell[i]&&this.logDwell(i,n);this.ariaLogger.flush()},i.prototype.regTenantSettingsUpdate=function(){var t=this;sj_evt.bind("bfbTenantSettings",function(i){var r=i[1];t.ctx.tn=r.tenantDisplayName;t.ctx.tnid=t.ctx.tnid||r.tenantObjectId;n.context&&!n.context.tenantId&&(n.context.tenantId=r.tenantObjectId)},!0,null,!0)},i.pagePerfMatchConfig={"RMS:BfbCssBundle":function(n){return n.name.match(/\/rms\/BfbCssBundle\//)},"RMS:BfbPreBundle":function(n){return n.name.match(/\/rms\/BfbPreBundle\//)},"RMS:BfbBundle":function(n){return n.name.match(/\/rms\/BfbBundle\//)},"RMS:BfbDependencies":function(n){return n.name.match(/\/rms\/BfbDependencies\//)}},i.instEventType="ClientInst",i.instClickEventType="DHTMLClick",i.instEventName="BAW",i}(),t;n.WebTelemetry=i,function(n){n[n.Serp=-1]="Serp";n[n.BingAtWork=0]="BingAtWork";n[n.BfbController=1]="BfbController";n[n.Gleam=2]="Gleam";n[n.Upsell=3]="Upsell";n[n.Feedback=4]="Feedback";n[n.Paw=5]="Paw";n[n.SkypeClient=6]="SkypeClient";n[n.Person=7]="Person";n[n.Document=8]="Document";n[n.Bookmark=9]="Bookmark";n[n.Building=10]="Building";n[n.FloorPlan=11]="FloorPlan";n[n.OrgChart=12]="OrgChart";n[n.Group=13]="Group";n[n.RefQna=14]="RefQna";n[n.PowerBi=15]="PowerBi";n[n.BookmarkSuggest=16]="BookmarkSuggest";n[n.ExploreQuery=17]="ExploreQuery";n[n.Carousel=18]="Carousel";n[n.WebResult=19]="WebResult";n[n.PowerApps=20]="PowerApps";n[n.Conversation=21]="Conversation";n[n.EmbeddedController=22]="EmbeddedController";n[n.UserNotification=23]="UserNotification";n[n.SuggestedQueries=24]="SuggestedQueries";n[n.Site=25]="Site";n[n.ExplorePage=26]="ExplorePage";n[n.LandingPage=27]="LandingPage";n[n.Mainline=37]="Mainline";n[n.BingAtWorkHomepage=43]="BingAtWorkHomepage";n[n.BingAtWorkChromeNewTab=44]="BingAtWorkChromeNewTab";n[n.UnconsciousArrivalUpsell=45]="UnconsciousArrivalUpsell";n[n.LowConfidenceGleam=46]="LowConfidenceGleam";n[n.Rewards=47]="Rewards";n[n.RightRail=60]="RightRail";n[n.Diag=999]="Diag";n[n.BingAtWorkNeo=70]="BingAtWorkNeo"}(t=n.EventScope||(n.EventScope={}));n.writeConversationId=r;typeof bfbTel=="undefined"&&(bfbTel=new i,sj_evt.fire("bfbWebTelemetryExists"))}(BingAtWork||(BingAtWork={})),function(n){function u(t){if(r){var u=[t.url,t.requestType],f=function(){t.onError&&t.onError(7,0,"throttled")};n.throttle(10,1e4,u,f,i,t)}else i(t)}function i(i){var h,c,l;if(i!=null){var a=i.timeout,v=i.onSuccess,u=i.onError,y=i.accessToken,e=i.url,o=i.body,p=i.tries,k=i.requestType,s=i.headers,d=i.convertPropertiesToPascalCase,r=sj_gx(),w=k||"GET",b=function(){return r.open(w,e,!0)};if(b(),r.withCredentials=!i.disableWithCredentials,r.ontimeout=function(){return u&&u(5,504,null)},r.timeout=a==null?0:a,h=p||1,c=function(t,i,r,f){n.whenWebTelemetryExists(function(){return bfbTel.logDiag(f,{url:e,reason:i})});u!=null&&u(i,t,r)},y!=null&&r.setRequestHeader("Authorization","Bearer "+y),f()&&w==="POST"&&r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),s)for(l in s)r.setRequestHeader(l,s[l]);r.onreadystatechange=function(){var i,u,f,e,s;if(r.readyState===4)if(r.status===200){if(v!=null){if(i=null,u={},r.responseText!=null&&r.responseText!=="")try{i=JSON.parse(r.responseText)}catch(l){c(-1,10,r.responseText,"Bad data");return}if(r.HEADERS_RECEIVED)try{f=r.getAllResponseHeaders();e=f.trim().split(/[\r\n]+/);e.forEach(function(n){var t=n.split(": "),i=t.shift(),r=t.join(": ");u[i]=r})}catch(a){}i=d?t(i):i;v(i,u)}}else--h>0?(r.abort(),b(),r.send(o)):(s=n.getError(r.status),c(r.status,s,r.responseText,"Ajax call failed with status "+r.status+". No retries available."))};r.send(o)}}function t(n){return n===null?null:n===undefined?undefined:typeof n=="number"||typeof n=="string"||typeof n=="boolean"?n:Array.isArray(n)?n.map(t):Object.keys(n).reduce(function(i,r){var u=""+r[0].toUpperCase()+r.slice(1);return i[u]=typeof n[r]=="object"?t(n[r]):n[r],i},{})}function f(){return typeof window=="undefined"||!window.navigator||!window.navigator.userAgent?!1:window.navigator.userAgent.indexOf("PhantomJS")>-1}var r=n.context&&n.context.isThrottlingEnabled;n.sendAjax=u}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function i(t,i,r){var u=n.getRequestMetadata(t,r);return n.mergeArgsIntoUrl(i,u)}function r(t,i,r,u,f,e){var o={url:t,accessToken:e,requestType:"POST",body:JSON.stringify(i),timeout:u,headers:f,onSuccess:r.onSuccess,onError:r.onError};n.augmentMsbMtAjax(o);n.sendAjax(o)}t.addArgsToUrl=i;t.sendPostRequest=r})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(n,t){var i=this;this.delayNotificationRequestMilliseconds=2500;this.isActionPending=!1;this.pendingRequest=null;this.config=t;this.userData=n;this.userDataApiUrl=""+t.apiUriBase+t.userDataApiUri;this.firePendingRequest=this.firePendingRequest.bind(this);this.cvid=typeof _G!="undefined"?_G.IG:undefined;_w.addEventListener("beforeunload",function(){return i.firePendingRequest()})}return t.prototype.notificationAction=function(n,t){this.notificationActionBatch([n],t)},t.prototype.firePendingRequest=function(){var n=this.pendingRequest;this.pendingRequest=null;this.isActionPending=!1;n&&this.notificationActionBatch(n.actions,n.onResponse)},t.prototype.notificationActionBatch=function(t,i){var r=this;if(t!=null&&t.length!==0){if(this.isActionPending){this.addToPending(t,i);return}this.isActionPending=!0;this.addToPending(t,i);setTimeout(function(){var n=r.pendingRequest,i=n.actions,t;r.pendingRequest=null;t={onSuccess:function(t){try{n.onResponse&&n.onResponse.onSuccess&&n.onResponse.onSuccess(t)}finally{r.firePendingRequest()}},onError:function(t){try{n.onResponse&&n.onResponse.onError&&n.onResponse.onError(t)}finally{r.firePendingRequest()}}};r.notificationRequest(t,{actions:i})},this.delayNotificationRequestMilliseconds)}},t.prototype.addToPending=function(n,t){if(this.pendingRequest==null){this.pendingRequest={actions:n,onResponse:t};return}if(this.pendingRequest.actions=this.pendingRequest.actions.concat(n),t){var i=this.pendingRequest.onResponse&&this.pendingRequest.onResponse.onSuccess,r=this.pendingRequest.onResponse&&this.pendingRequest.onResponse.onError;t.onSuccess&&(i=i?function(n){i(n);t.onSuccess(n)}:t.onSuccess);t.onError&&(r=r?function(n){r(n);t.onError(n)}:t.onError);this.pendingRequest.onResponse={onSuccess:i,onError:r}}},t.prototype.clear=function(t){var i={url:this.userDataApiUrl,requestType:"DELETE",onSuccess:t&&t.onSuccess||function(){console.log("UserDataClient: succeed to clear user data")},onError:t&&t.onError||function(){console.log("UserDataClient: fail to clear user data")}};n.sendAjax(i)},t.prototype.notificationRequest=function(t,i){var r,u,f;i===void 0&&(i=null);r={};this.cvid!==undefined&&(r.cvid=this.cvid);u=this.userDataApiUrl+"/notifications";f="PUT";this.config.notificationDataUpdateApiUri&&(u=""+this.config.apiUriBase+this.config.notificationDataUpdateApiUri,f="POST");var o=n.getRequestMetadata(this.config,r),s=n.mergeArgsIntoUrl(u,o),h=function(r,u){if(sj_evt.fire("bfbUpdateNotifications",r,i,u,!1,n.getSucceededEventDetails(r,u,!1)),t&&t.onSuccess)t.onSuccess(r)},c=function(i,r,u){if(sj_evt.fire("bfbUpdateNotifications_Failed",i,r,u,n.getFailedEventDetails(i,r)),t&&t.onError)t.onError(i)},e={url:s,timeout:this.config.userDataTimeout,onSuccess:h,onError:c};e.body=JSON.stringify(i);e.requestType=f;sj_evt.fire("bfbUpdateNotifications_Started",n.getStartedEventDetails());n.sendAjax(e)},t}();t.UserDataVNextClient=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function t(){var t=localStorage.getItem("UserData");if(t!=null)try{this.localUserData=JSON.parse(t)}catch(i){this.isInvalid=!0}this.localUserData==null&&(this.localUserData={notifications:[]})}return t.prototype.isValid=function(){return!this.isInvalid},t.prototype.getNotificationInfo=function(n){if(this.isInvalid)return null;var t=this.localUserData.notifications[n];return t!=null?t:(this.localUserData.notifications[n]={impressionCount:0,suppressedCount:0,dismissedCount:0},this.localUserData.notifications[n])},t.prototype.logNotificationAction=function(t,i){if(!this.isInvalid){var r=this.getNotificationInfo(t),u=(new Date).getTime();switch(i){case 0:r.impressionCount++;r.firstImpressionTimestamp==null&&(r.firstImpressionTimestamp=u);r.lastImpressionTimestamp=u;break;case 3:r.suppressedCount++;break;case 2:r.dismissedTimestamp=u;r.dismissedCount==null?r.dismissedCount=1:r.dismissedCount++;break;default:return}localStorage.setItem("UserData",JSON.stringify(this.localUserData))}},t.prototype.clear=function(){localStorage.removeItem("UserData")},t}();t.LocalUserDataClient=i})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i=function(){function i(t,i,r){var u=this;this.enabled=function(n){return!u.notificationSystemCfg.e||!n.cfg.e?0:null};this.forced=function(n){return n.forced&&n.forcedNotifKind!=null?n.forcedNotifKind===n.kind?1:0:null};this.dismissed=function(n){if(n.cfg.maxDismissals&&n.cfg.timeIntervalBetweenDismissalsInSec){if(n.info.dismissedCount&&n.info.dismissedCount>=n.cfg.maxDismissals)return 0;if(n.info.dismissedTimestamp){var t=(new Date).getTime(),i=(t-n.info.dismissedTimestamp)/1e3;return i<n.cfg.timeIntervalBetweenDismissalsInSec?0:null}return null}return n.info.dismissedTimestamp?0:null};this.maxImpressionsAndInterval=function(n){if(n.cfg.maxImps&&n.info.impressionCount>=n.cfg.maxImps)return 0;if(n.cfg.timeIntervalBetweenImpressionsInSec&&n.info.lastImpressionTimestamp){var t=(new Date).getTime(),i=(t-n.info.lastImpressionTimestamp)/1e3;if(i<n.cfg.timeIntervalBetweenImpressionsInSec)return 0}return null};this.autoSignedIn=function(n){var t=n.cfg,i=n.ssoSucceeded,r=n.autoSignedIn;return t.mustBeAutoSignedIn?i&&r?null:0:null};this.msaSignedIn=function(n){var t=n.cfg,i=n.hasMsa;return t.mustBeMsaSignedIn&&!i?0:null};this.signedOut=function(n){var t=n.cfg,i=n.hasMsa,r=n.ssoSucceeded;return t.mustBeAadSignedIn?null:!t.mustBeAutoSignedIn&&!t.mustBeMsaSignedIn&&!t.mustBeUpsell?i||r?0:null:void 0};this.isUpsell=function(n){var t=n.cfg,i=n.isUpsell;return t.mustBeUpsell&&!i?0:null};this.isRewards=function(n){var i=n.cfg,t;return i.mustBeRewards&&i.mustBeAadSignedIn?(t=sj_cook.get("_RwBf","e"),t&&t.length>1?null:0):null};this.show=function(){return 1};this.notificationSystemCfg=n.chk(t,0);this.localUserDataClient=n.chk(i,1);this.controllerOptions=r;this.notificationRules=[this.enabled,this.forced,this.dismissed,this.maxImpressionsAndInterval,this.autoSignedIn,this.msaSignedIn,this.signedOut,this.isRewards,this.isUpsell,this.show]}return i.prototype.decide=function(i,r,u,f){var c=null,v=[],y=this.notificationSystemCfg,b=y.forced,k=y.forcedNotifKind,p,s,a,w,h;if(this.localUserDataClient.isValid())for(p in this.notificationSystemCfg.clientNotifications){var e=n.enumPropertyToValue(p,t.NotificationKind),l=this.notificationSystemCfg.clientNotifications[e],d=this.localUserDataClient.getNotificationInfo(e),o=0;for(s=0,a=this.notificationRules;s<a.length;s++){if(w=a[s],h=w({kind:e,cfg:l,info:d,ssoSucceeded:i,autoSignedIn:r,forced:b,forcedNotifKind:k,hasMsa:u,isUpsell:f}),h!=null){h===1&&c==null?c=this.buildNotification(e,l,1):h===2&&v.push(this.buildNotification(e,l,2));break}o++}}return{shown:c,suppressed:v}},i.prototype.buildNotification=function(t,i,r){var e=i.renderMode,o=i.targetElementId,s=i.alignment,h=i.titleStrKey,c=i.bodyStrKey,l=i.actionBtns,a=i.showPrivacyFtr,v=i.headerImg,y=i.renderAgg,p=i.useThemeRunner,w=i.popupWidth,b=i.popupOffset,k=i.popupArrowOffset,d=i.popupPadding,g=i.useExpQries,nt=i.maxQueries,tt=i.isUnVNext,it=i.showUserInfo,ft=i.mustBeRewards,rt=i.mustBeUpsell,u=i.externalLink,f=i.externalLabelKey,ut=i.isSerpSSOAdminThemeEnabled;return{notifyKind:t,behavior:r,renderMode:e,targetElementId:o,alignment:s,title:n.Strings[h],body:n.Strings[c],actionBtns:this.buildActionButtons(l,rt,f,u),showPrivacyFtr:a,headerImg:v,renderAgg:y,useThemeRunner:p,popupWidth:w,popupOffset:b,popupArrowOffset:k,popupPadding:d,externalLink:u,externalLabelKey:f,useExpQries:g,maxQueries:nt,isUnVNext:tt,showUserInfo:it,isSerpSSOAdminThemeEnabled:ut}},i.prototype.buildActionButtons=function(t,i,r,u){var e=this,f=[];return t.forEach(function(t){switch(t){case 2:f.push({label:n.Strings.NotifyActionLabel_Sso_GotIt,target:"GOTIT",isHighlighted:!0});break;case 3:f.push({label:n.Strings.NotifyActionLabel_Sso_SignOut,target:"SIGNOUT"});break;case 0:f.push({label:n.Strings.NotifyActionLabel_SignIn,target:"SIGNIN",isHighlighted:!0,url:i?e.controllerOptions.signInUpsellLink:e.controllerOptions.signInLink});break;case 1:f.push({label:n.Strings.NotifyActionLabel_LearnMore,target:"LEARN",url:e.controllerOptions.learnLink});break;case 4:f.push({label:n.Strings.NotifyActionLabel_SwitchAccounts,target:"SWITCHACCOUNTS",isHighlighted:!0,url:i?e.controllerOptions.signInUpsellLink:e.controllerOptions.signInLink});break;case 5:f.push({label:n.Strings.NotifyActionLabel_EhpNoThanks,target:"EHPNOTHANKS"});break;case 6:f.push({label:n.Strings.NotifyActionLabel_EhpSoundsGreat,isHighlighted:!0,target:"GOTIT"});break;case 8:f.push({label:n.Strings.NotifyActionLabel_MaybeLater,target:"MAYBELATER"});break;case 9:f.push({label:n.Strings.NotifyActionLabel_Unlink,target:"UNLINK"});break;case 7:e.validateExternalButtonOptions(r,u)&&f.push({label:n.Strings[r],target:"EXTACTION",url:u})}}),f},i.prototype.validateExternalButtonOptions=function(t,i){return i?t?!0:!1:!1},i}();t.ClientNotificationEngine=i})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function r(r,f,h,c,l,a,v,y,p,w){var nt,tt;if(r!=null){var rt=r,kt=r,g=r.title,k=r.headerImg,ut=r.actionBtns,ot=r.showPrivacyFtr,st=r.notifyKind,dt=r.useExpQries,gt=r.queries,ni=r.maxQueries,ht=r.isUnVNext,d=r.isSerpSSOAdminThemeEnabled,et=rt.body,it=rt.useThemeRunner,ti=rt.popupOffset,ii=rt.popupWidth,ct=kt.qryLbl,ft=h||"#0078D4",lt="#FFFFFF",at="#111111";c&&d&&(lt="#"+c[1],at="#"+c[2]);c&&(ft="#"+c[0]);nt=null;tt=null;switch(r.alignment){case 1:nt="bw-unTopLft";tt="bw-unArwTop bw-unArwTopLft";break;case 2:nt="bw-unTopRt";tt="bw-unArwTop bw-unArwTopRt";break;case 3:nt="bw-unLftTop";tt="bw-unArwLftTop";break;case 4:nt="bw-unAcctRt";tt="bw-unArwTop bw-unArwAcctRt"}var ri=f===1?"bw-unSerp":"bw-unHomepg",ui="b_hide "+nt+" "+ri,b=sj_ce("div",ht?"bw-un-vnext":"bw-un",ui);b.setAttribute("data-priority","2");b.setAttribute("tabindex","0");var wi=function(){var n=sj_ce("div",null,"bw-unThmRnr");return n.style.backgroundColor=ft,n},vt="http://www.w3.org/2000/svg",fi=function(n){var t=document.createElementNS(vt,"svg");return n&&t.setAttribute("class",n),t},ei=function(n,t){var i=document.createElementNS(vt,"path");return i.setAttribute("d",n),t&&i.setAttribute("fill",t),i},oi=function(t){var i=sj_ce("a",null,"bw-unDis");return t&&i.classList.add(t),i.title=n.Strings.Dismiss,i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.appendChild(si(at)),i},si=function(n){var t=fi("bw-unDisSVG"),i=ei("M12 0.691L6.699 6L12 11.309L11.309 12L6 6.699L0.691 12L0 11.309L5.301 6L0 0.691L0.691 0L6 5.301L11.309 0L12 0.691Z",n);return t.appendChild(i),t},hi=function(){var n=sj_ce("div",null,"bw-unBottomCnt"),t=sj_ce("div",null,"bw-unActs");return d&&(n.style.backgroundColor="#F5F5F5",n.style.paddingLeft="16px"),t.innerHTML=i(ut,a,h,!0,d),n.appendChild(t),n},yt=function(n){var t=ci(n);return t+";base64,"+n},ci=function(n){var t=n&&n.length>0?n.charAt(0):"i";switch(t){case"/":return"data:image/jpeg";case"P":return"data:image/svg+xml";case"i":default:return"data:image/png"}},li=function(t){var i=sj_ce("a",null,"bw-unDis");return t&&i.classList.add(t),i.title=n.Strings.Dismiss,i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.innerHTML='<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIVBMVEX///9VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVW83/q/AAAAC3RSTlMANzo9QEK9v+Ln7AfYsJ8AAAA7SURBVAgdY0hlYGAIY5AMYGCdyMA4hSFSgIFBQnQiUJB5lgKQZF0VACSjQpcCmUsZogJACMgoBQqGAwAVzQn7WBRrIQAAAABJRU5ErkJggg==" alt="'+n.Strings.Dismiss+'" />',i},ai=function(){var n=sj_ce("div",null,"bw-unHeaderCnt");return n.appendChild(oi(k?"bw-unShiftUp":it?"bw-unShiftDn":undefined)),v&&n.appendChild(pt()),k&&(n.appendChild(sj_ce("div",null,"bw-unHdrImg bw-"+k)),n.appendChild(sj_ce("div",null,"bw-unHdrImgShdw"))),d&&(n.style.backgroundColor=lt),n},pt=function(){var n=sj_ce("div",null,"bw-unLogo"),t;return k&&n.classList.add("bw-unShiftUp"),t=sj_ce("img"),t.src=y?v:yt(v),n.appendChild(t),n},wt=function(){var n=sj_ce("div",null,"bw-unTtl"),i,u;if(d&&(n.style.marginTop="8px"),st===t.NotificationKind.SsoSucceeded){i=g.indexOf("{");u=i+3;n.innerText=g.substring(0,i);var r=sj_ce("span",null,"bw-unTtl-tNamePart"),f=sj_ce("span",null,"bw-unTtl-tName"),e=sj_ce("span",null,"bw-unTtl-postfix");f.innerText=w;e.innerText=g.substring(u,g.length);r.appendChild(f);r.appendChild(e);n.appendChild(r)}else n.innerText=g;return n},bt=function(){var n=sj_ce("div",null,"bw-unBdy");return n.innerText=et,ot&&n.appendChild(vi()),n},vi=function(){var t=sj_ce("div"),i;return t.innerText=n.Strings.NotifyBody_Sso_PrivateMessage,i=sj_ce("div"),i.innerHTML=d?'\n                <a href="'+l+'">'+n.Strings.LearnMore+"<\/a>\n            ":'\n                <svg xmlns="http://www.w3.org/2000/svg" width="10" height="12" viewBox="0 0 10 12" fill="none">\n                    <path d="M9.5 5.3V12H0.5V5.3H2V3.1C2 2.6 2.1 2.2 2.2 1.9 2.4 1.5 2.6 1.2 2.9 0.9 3.1 0.6 3.4 0.4 3.8 0.2 4.2 0.1 4.6 0 5 0 5.4 0 5.8 0.1 6.2 0.2 6.6 0.4 6.9 0.6 7.1 0.9 7.4 1.2 7.6 1.5 7.8 1.9 7.9 2.2 8 2.6 8 3.1V5.3H9.5ZM2.8 5.3H7.3V3.1C7.3 2.7 7.2 2.4 7.1 2.2 7 1.9 6.8 1.6 6.6 1.4 6.4 1.2 6.2 1.1 5.9 0.9 5.6 0.8 5.3 0.8 5 0.8 4.7 0.8 4.4 0.8 4.1 0.9 3.8 1.1 3.6 1.2 3.4 1.4 3.2 1.6 3 1.9 2.9 2.2 2.8 2.4 2.8 2.7 2.8 3.1V5.3Z" fill="#919191"/>\n                <\/svg>\n                <a href="'+l+'">'+n.Strings.LearnMore+"<\/a>\n            ",t.appendChild(i),t},yi=function(){var n=sj_ce("div",null,"bw-unAdminTopCnt");return n.appendChild(wt()),n.appendChild(bt()),n},pi=function(){var n=sj_ce("div",null,"bw-unTopCnt");return v&&n.appendChild(pt()),k&&(n.appendChild(sj_ce("div",null,"bw-unHdrImg bw-${headerImg}")),n.appendChild(sj_ce("div",null,"bw-unHdrImgShdw"))),n.appendChild(wt()),n.appendChild(bt()),n};return ht?(d?(b.style.border="1px solid #DDDDDD",b.appendChild(ai()),b.appendChild(yi())):(b.appendChild(li(k?"bw-unShiftUp":it?"bw-unShiftDn":undefined)),b.appendChild(pi())),b.appendChild(hi())):b.innerHTML="\n                "+(it?'<div class="bw-unThmRnr" style="background-color:'+ft+'"><\/div>':"")+'\n                <div class="'+tt+'">\n                    '+e(it?ft:null)+'\n                <\/div>\n                <a class="bw-unDis '+(k?"bw-unShiftUp":it?"bw-unShiftDn":"")+'" title="'+n.Strings.Dismiss+'" role="button" tabindex="0">\n                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIVBMVEX///9VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVW83/q/AAAAC3RSTlMANzo9QEK9v+Ln7AfYsJ8AAAA7SURBVAgdY0hlYGAIY5AMYGCdyMA4hSFSgIFBQnQiUJB5lgKQZF0VACSjQpcCmUsZogJACMgoBQqGAwAVzQn7WBRrIQAAAABJRU5ErkJggg==" alt="'+n.Strings.Dismiss+'" />\n                <\/a>\n                <div class="bw-unCnt">\n                    <div class="bw-unLogo '+(k?"bw-unShiftUp":"")+'">\n                    '+(v?""+(y?"<img src="+v+" />":"<img src="+yt(v)+" />"):"")+"\n                    <\/div>\n                    "+(k?'<div class="bw-unHdrImg bw-'+k+'"><\/div>\n                        <div class="bw-unHdrImgShdw"><\/div>':"")+'\n                    <div class="bw-unTtl">'+s(g)+'<\/div>\n                    <div class="bw-unBdy">\n                        '+(et?'<div class="bw-unBdyTxt">'+et+"<\/div>":"")+"\n                        "+(dt?(ct?'<div class="bw-unQrLbl">'+ct+"<\/div>":"")+'\n                        <ul class="bw-unQrList">'+u(gt,ni,h,p,st)+"<\/ul>":"")+"\n                    <\/div>\n                    "+(ut&&ut.length>0?'<div class="bw-unActs">\n                            '+i(ut,a,h)+"\n                        <\/div>":"")+"\n                    "+(ot?'<div class="bw-unFtr">\n                            <span>'+o(n.Strings.PrivacyFooter,l)+"<\/span>\n                        <\/div>":"")+"\n                <\/div>\n            ",r.alignment==4&&(b.style.marginLeft=ti+"px",b.style.width=ii+"px"),b}}function u(n,t,i,r,u){var e=[],o;return n&&(o=0,n.slice(0,t).forEach(function(n){var t=f(n,i,r,"B4BUN",u);e.push(t.outerHTML)})),e.join("")}function f(t,i,r,u,f){var o=sj_ce("li"),s=n.strFormat(r,u,f,encodeURIComponent(t)),e=sj_ce("a",null,"bw-expQryLnk");return e.href=s,e.target="_blank",e.innerText=t,i&&(e.style.color=i),o.appendChild(e),o}function e(n){var i=n||"#f9f9f9",t=n||"#ccc";return'\n            <svg class="bw-ttipArwSvg" viewBox="0 0 13 10">\n                <g fill="transparent" stroke="'+t+'" stroke-opacity="0.33" stroke-width="0.667">\n                    <path d="M0,0 L6.5,9.1 L14,0"><\/path>\n                <\/g>\n                <g fill="transparent" stroke="'+t+'" stroke-opacity="0.67" stroke-width="0.667">\n                    <path d="M-1,0.05 L6.5,9.1 L14,0.05"><\/path>\n                <\/g>\n                <g fill="'+i+'" stroke="'+t+'">\n                    <path d="M0,0 L6.5,8 L13,0"><\/path>\n                <\/g>\n            <\/svg>'}function i(n,t,i,r,u){var f="";return n.forEach(function(n){var e=n.target==="SIGNOUT",o;e&&(f+='<form id="bw-unSnOtFrm" action="'+t+'" method="post">');o=n.target==="GOTIT";f+="<a "+(n.url?'href="'+n.url+'"':"")+"\n                    "+(n.isHighlighted?'style="background-color: '+(r?"#0078D4":i)+'"':"")+'\n                    class="bw-unActBtn bw-unActBtn'+n.target+" "+(n.isHighlighted?"bw-unActBtnDef":"bw-unActBtnOth")+" "+(r&&u&&o?"bw-unActBtnSmallRnd":"")+" "+(r&&!u?"bw-unActBtnRnd":"")+'"\n                    title="'+n.label+'"\n                    role="button"\n                    tabindex="0">\n                    '+n.label+"\n                <\/a>";e&&(f+="<\/form>")}),f}function o(n,t){if(!n)return null;var u='<a href="'+t+'" target="_blank" class="bw-unLnk">',f="<\/a>",i="{",r="}",e=n.indexOf(i),o=n.indexOf(r);return e>=0&&o>=0&&e<o?n.replace(i,u).replace(r,f):u+n.replace(i,"").replace(r,"")+f}function s(n){if(n){var t=n.split("\n");return"<span>"+t.map(function(n,i){return"<span key="+i+">"+n+(i<t.length-1?"<br/>":"")+"<\/span>"}).join("")+"<\/span>"}}t.createPopup=r})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function u(t,i,r,u,e,h,c,l,a,v){var p;if(t){var w=t.actionBtns,y=sj_ce("div","bw-un-vnext-overlay","b_hide bw-unAcctRt bw-unSerp");if(y.appendChild(f(u,e,a,c,l,h,v)),y.appendChild(o(i)),p=w&&w[0],p&&p.url)return y.appendChild(s(p,r)),y}}function f(n,t,u,f,o,s,h){var l=sj_ce("div",null,i.headerContainer),c=sj_ce("div",null,i.swoopContainer);return c.appendChild(r(n,""+i.swoopImage)),c.appendChild(r(h,i.iconsCommon+" "+i.excelImage+" "+i.leanRightCommon)),c.appendChild(r(u,i.iconsCommon+" "+i.avatar1Image+" "+i.leanLeftCommon)),c.appendChild(r(f,i.iconsCommon+" "+i.wordImage+" "+i.leanLeftCommon)),c.appendChild(r(t,i.iconsCommon+" "+i.sharepointImage+" "+i.leanRightCommon)),c.appendChild(r(o,i.iconsCommon+" "+i.powerpointImage+" "+i.leanLeftCommon)),c.appendChild(r(s,i.iconsCommon+" "+i.avatar2Image+" "+i.leanRightCommon)),c.appendChild(e()),l.appendChild(c),l}function r(n,t){var i=sj_ce("img");return i.src=n,i.setAttribute("class",t),i.alt="",i}function e(){var u=sj_ce("button",null,i.dismiss),t,r;return u.setAttribute("title",n.Strings.Dismiss),t=_d.createElementNS("http://www.w3.org/2000/svg","svg"),t.setAttribute("width","12"),t.setAttribute("height","12"),t.setAttribute("viewBox","0 0 12 12"),t.setAttribute("title",n.Strings.Dismiss),r=_d.createElementNS("http://www.w3.org/2000/svg","path"),r.setAttribute("d","M12 0.7L6.7 6 12 11.3 11.3 12 6 6.7 0.7 12 0 11.3 5.3 6 0 0.7 0.7 0 6 5.3 11.3 0 12 0.7Z"),r.setAttribute("fill","#666"),t.appendChild(r),u.appendChild(t),u}function o(t){var u=sj_ce("div",null,i.textContainer),r=sj_ce("div",null,i.searchOnBing),f;return r.innerText=n.strFormat(n.Strings.SearchCompanyNameOnBing,t),r.setAttribute("role","heading"),r.setAttribute("aria-level","2"),f=sj_ce("div",null,i.speedySearch),f.innerText=n.Strings.SpeedySearchText,u.appendChild(r),u.appendChild(f),u}function s(n,t){var r=sj_ce("div",null,i.signInContainer);return r.appendChild(h(n,t)),r}function h(t,r){var u=sj_ce("a",null,i.signInButton);return u.classList.add(""+i.signInButton+t.target),u.href=t.url,u.title=t.label,u.tabIndex=0,u.innerText=r?n.Strings.SwitchToYourWork:n.Strings.SignInToWork,u}var i={dismiss:"bw-unDis",textContainer:"bw-unTextContainer",searchOnBing:"bw-unSearchOnBing",speedySearch:"bw-unSpeedySearch",signInContainer:"bw-unActs",signInButton:"bw-unActBtn",headerContainer:"bw-unHeader",swoopContainer:"bw-unSwoop",swoopImage:"bw-unSwoopimage",iconsCommon:"bw-unIcon",excelImage:"bw-unExcel",leanRightCommon:"bw-unLeanRight",leanLeftCommon:"bw-unLeanLeft",sharepointImage:"bw-unSharepoint",wordImage:"bw-unWord",powerpointImage:"bw-unPowerpoint",avatar1Image:"bw-unAvatar1",avatar2Image:"bw-unAvatar2"};t.createPopupForSignInUpsell=u})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function r(t,i,r,o){if(t!=null){var l=t.actionBtns,a=t.title,v=l&&l[0],h=sj_ce("div","bw-un-vnext-footer",null);return h.appendChild(u(o)),h.appendChild(e()),h.appendChild(f(i,a)),h.appendChild(s(v,r)),h.appendChild(c()),h}}function u(n){var r=sj_ce("div",null,i.ofcContainer),t=sj_ce("img");return t.src=n,t.setAttribute("width","117px"),t.setAttribute("height","125px"),t.alt="",r.appendChild(t),r}function f(n,t){var r=sj_ce("div",null,i.message);return r.appendChild(o(n,t)),r}function e(){var r=sj_ce("div",null,i.searchIcon),n=_d.createElementNS("http://www.w3.org/2000/svg","svg"),t;return n.setAttribute("width","32"),n.setAttribute("height","32"),n.setAttribute("viewBox","0 0 32 32"),n.setAttribute("fill","none"),t=_d.createElementNS("http://www.w3.org/2000/svg","path"),t.setAttribute("d","M11 0C10 0 9 0.1 8.1 0.4 7.1 0.7 6.3 1 5.5 1.5 4.6 2 3.9 2.6 3.2 3.2 2.6 3.9 2 4.6 1.5 5.5 1 6.3 0.6 7.2 0.4 8.1 0.1 9 0 10 0 11 0 12 0.1 13 0.4 13.9 0.7 14.9 1 15.7 1.5 16.5 2 17.4 2.6 18.1 3.2 18.8 3.9 19.4 4.6 20 5.5 20.5 6.3 21 7.2 21.4 8.1 21.6 9 21.9 10 22 11 22 12.3 22 13.5 21.8 14.7 21.3 15.9 20.9 17 20.3 18 19.5L30.3 31.7C30.5 31.9 30.7 32 31 32 31.3 32 31.5 31.9 31.7 31.7 31.9 31.5 32 31.3 32 31 32 30.7 31.9 30.5 31.7 30.3L19.5 18C20.3 17 20.9 15.9 21.3 14.8 21.8 13.6 22 12.3 22 11 22 10 21.9 9 21.6 8.1 21.3 7.1 21 6.3 20.5 5.5 20 4.6 19.4 3.9 18.8 3.2 18.1 2.6 17.4 2 16.5 1.5 15.7 1 14.8 0.6 13.9 0.4 13 0.1 12 0 11 0ZM11 20C9.8 20 8.6 19.8 7.5 19.3 6.4 18.8 5.5 18.2 4.6 17.4 3.8 16.5 3.2 15.6 2.7 14.5 2.3 13.4 2 12.3 2 11 2 9.8 2.2 8.6 2.7 7.5 3.2 6.4 3.8 5.5 4.6 4.6 5.5 3.8 6.4 3.2 7.5 2.7 8.6 2.3 9.8 2 11 2 12.2 2 13.4 2.2 14.5 2.7 15.6 3.2 16.5 3.8 17.4 4.6 18.2 5.5 18.8 6.4 19.3 7.5 19.8 8.6 20 9.8 20 11 20 12.2 19.8 13.4 19.3 14.5 18.8 15.6 18.2 16.5 17.4 17.4 16.5 18.2 15.6 18.8 14.5 19.3 13.4 19.8 12.3 20 11 20Z"),t.setAttribute("fill","#0078D7"),n.appendChild(t),r.appendChild(n),r}function o(t,r){var f=sj_ce("div",null,i.textContainer),u=sj_ce("div",null,i.searchOnBing),e;return u.innerText=n.strFormat(n.Strings.SearchCompanyNameOnBing,t),u.setAttribute("role","heading"),u.setAttribute("aria-level","2"),e=sj_ce("div",null,i.speedySearch),e.innerText=r,f.appendChild(u),f.appendChild(e),f}function s(n,t){var r=sj_ce("div",null,i.signInContainer);return r.appendChild(h(n,t)),r}function h(t,r){var u=sj_ce("a",null,i.signInButton);return u.classList.add(""+i.signInButton+t.target),u.href=t.url||"",u.title=t.label,u.tabIndex=0,r?(u.style.padding="0px 8px",u.innerText=n.Strings.SwitchToYourWork):(u.style.padding="0px 16px",u.innerText=n.Strings.SignInToWork),u}function c(){var u=sj_ce("button",null,i.dismiss),t,r;return u.title=n.Strings.Dismiss,t=_d.createElementNS("http://www.w3.org/2000/svg","svg"),t.setAttribute("width","16"),t.setAttribute("height","16"),t.setAttribute("viewBox","0 0 16 16"),t.setAttribute("fill","none"),t.setAttribute("title",n.Strings.Dismiss),r=_d.createElementNS("http://www.w3.org/2000/svg","path"),r.setAttribute("d","M16 0.9L8.9 8 16 15.1 15.1 16 8 8.9 0.9 16 0 15.1 7.1 8 0 0.9 0.9 0 8 7.1 15.1 0 16 0.9Z"),r.setAttribute("fill","#666"),t.appendChild(r),u.appendChild(t),u}var i={dismiss:"bw-unDis",message:"bw-unMessage",searchIcon:"bw-unSearchIcon",textContainer:"bw-unTextContainer",searchOnBing:"bw-unSearchOnBing",speedySearch:"bw-unSpeedySearch",signInContainer:"bw-unActs",signInButton:"bw-unActBtn",ofcContainer:"bw-unOfc"};t.createSignInFooterUpsell=r})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function i(t,i,h,c,l){var a,y;if(t!=null){var v=t.actionBtns,k=t.title,d=t.body,g=v&&v[0],nt=v&&v[1],tt=h?"bw-un-vnext-anaFooter":"bw-un-vnext-anaFooterNol",p=sj_ce("div",tt,null),w,b;return h&&(w=u(l),b=f()),a=sj_ce("div",null,"bw-ana-container"),y=sj_ce("div",null,"bw-ana-buttonContainer"),!c&&h&&(a.appendChild(w),a.appendChild(b)),a.appendChild(r(i)),a.appendChild(e(k,d)),c&&h&&(a.appendChild(b),a.appendChild(w)),y.appendChild(s(g)),y.appendChild(o(nt)),p.appendChild(a),p.appendChild(y),p}}function r(n){var t=sj_ce("div",null,"bw-ana-icon-container"),i=sj_ce("img");return i.src=n,t.appendChild(i),t}function u(n){var t=sj_ce("span",null,"bw-ana-dn");return t.textContent=n,t}function f(){return sj_ce("div",null,"bw-ana-div")}function e(n,t){var i=sj_ce("span",null,"bw-ana-titleContent"),u=sj_ce("span",null,"bw-ana-title"),r;return u.textContent=n,r=sj_ce("span",null,"bw-ana-subtitle"),r.textContent=t,i.appendChild(u),i.appendChild(r),i}function o(n){var r=sj_ce("div",null,"bw-unActs"),i=sj_ce("div",null,"bw-ana-download"),t;return i.classList.add("bw-unActBtn"+n.target),t=sj_ce("a",null,"bw-ana-a"),t.href=n.url,t.innerText=n.label,i.appendChild(t),r.appendChild(i),r}function s(n){var t=sj_ce("div",null,"bw-ana-maybeLater bw-unDis");return t.innerText=n.label,t.setAttribute("role","button"),t}t.createAnaheimFooterUpsell=i})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(n){var t;(function(n){n[n.FirstRun=0]="FirstRun";n[n.None=1]="None";n[n.FirstRunCarousel=4]="FirstRunCarousel";n[n.SsoSucceeded=5]="SsoSucceeded";n[n.MsaSignIn=6]="MsaSignIn";n[n.SignOut=7]="SignOut";n[n.BookmarkTip=8]="BookmarkTip";n[n.FileTip=9]="FileTip";n[n.PersonTip=10]="PersonTip";n[n.GenericTip=11]="GenericTip";n[n.Welcome=12]="Welcome";n[n.MainlineFirstRun=13]="MainlineFirstRun";n[n.ScopeTab=14]="ScopeTab";n[n.VerticalFirstRun=15]="VerticalFirstRun";n[n.NoConfident=16]="NoConfident";n[n.Covid19=17]="Covid19";n[n.EnterpriseHomepageFre=18]="EnterpriseHomepageFre";n[n.IndustryNews=19]="IndustryNews";n[n.EnterpriseHomepageFreV2=20]="EnterpriseHomepageFreV2";n[n.SignoutRetention=21]="SignoutRetention";n[n.SignoutRetentionLandingPage=22]="SignoutRetentionLandingPage";n[n.SignInFooterUpsell=23]="SignInFooterUpsell";n[n.OverlaySignInUpsell=24]="OverlaySignInUpsell";n[n.AnaheimFooterUpsell=25]="AnaheimFooterUpsell";n[n.RewardsFRENotification=26]="RewardsFRENotification"})(t=n.NotificationKind||(n.NotificationKind={}))})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t;(function(t){t.tenantSettingsAjaxBound=n.Service.tenantSettingsAjaxBound;var i=(n.context||{isVerticalConfigFromTenantSettings:!1}).isVerticalConfigFromTenantSettings,r=function(){function r(i,r){var u=this;this.config=i;this.onAjaxLoad=function(){var t=n.context,i=t.tenantId,r=t.isCheckingTenantIdOnAjaxEnabled;r&&i!==(u.cachedTenantSettings&&u.cachedTenantSettings.tenantObjectId)&&(n.isTenantSettingsPrefetchStarted=!1,u.loadTenantSettings());u.broadcastImpl()};this.tenantSettingsApiUrl=""+i.apiUriBase+i.tenantSettingsApiUri;this.onResponse=r;t.tenantSettingsAjaxBound||(sj_evt.bind("ajax.load",this.onAjaxLoad,!0,null,!0),t.tenantSettingsAjaxBound=!0)}return r.isValid=function(n){return!!(n&&n.tenantObjectId&&n.tenantDisplayName)},r.prototype.loadTenantSettings=function(){var t=this,i={onSuccess:function(i,r,u){i&&(t.broadcast(i,r,u),t.onResponse&&t.onResponse.onSuccess&&t.onResponse.onSuccess(i,r,u))},onError:function(i,r,u){sj_evt.fire("bfbTenantSettingsFailed",i,r,u,n.getFailedEventDetails(i,r));t.onResponse&&t.onResponse.onError&&t.onResponse.onError(i,r);r===404&&(t.isTenantNotProvisioned=!0)}};this.getTenantSettings(i)},r.prototype.getTenantSettings=function(t){if(!n.isTenantSettingsPrefetchStarted){sj_evt.fire("bfbTenantSettingsStarted",n.getStartedEventDetails());n.isTenantSettingsPrefetchStarted=!0;var u=__assign(__assign({},n.getRequestMetadata(this.config)),{isLokiVerticalConfigRequired:i}),f=n.mergeArgsIntoUrl(this.tenantSettingsApiUrl,u),r={url:f,requestType:"GET",timeout:this.config.tenantSettingsTimeout,onSuccess:t&&t.onSuccess?function(n,i){return t.onSuccess(n.tenantSettings,n.user,i)}:null,onError:t&&t.onError};n.augmentMsbMtAjax(r);n.sendAjax(r)}},r.prototype.broadcast=function(t,i,u){r.isValid(t)&&(this.cachedTenantSettings=t,this.cachedUserInfo=i,this.cachedTenantConfig=this.convertToTenantConfig(t),this.broadcastImpl(!1,u))},r.prototype.convertToJson=function(n){if(!n)return"EmptyJSON";var t=__assign({},n);return delete t.adminEmail,delete t.exploreQueries,delete t.iconLarge,delete t.iconLargeChecksum,JSON.stringify(t)},r.prototype.getCachedTenantSettings=function(){return this.cachedTenantSettings},r.prototype.getIsTenantNotProvisioned=function(){return this.isTenantNotProvisioned},r.prototype.convertToTenantConfig=function(n){var t=n.tenantDisplayName,i=n.iconLarge,r=n.iconLargeChecksum,u=n.theme,f=n.adminEmail,e=n.themeColors;return{displayName:t,theme:u,iconLarge:i,iconLargeChecksum:r,adminEmail:f,themeColors:e}},r.prototype.broadcastImpl=function(t,i){var r=this;t===void 0&&(t=!0);this.cachedTenantSettings&&sj_evt.fire("bfbTenantSettings",this.cachedTenantSettings,this.cachedUserInfo,i,t,n.getSucceededEventDetails(this.cachedTenantSettings,i,t));this.cachedTenantConfig&&sj_evt.fire("bfbtcfg",this.cachedTenantConfig);this.cachedUserInfo&&this.cachedUserInfo.displayName&&this.cachedUserInfo.userPrincipalName?sj_evt.fire("bfbTenantSettingsUserInfo"):this.isUserInfoRetried||(this.isUserInfoRetried=!0,sj_evt.bind("aad:signedin",function(){n.isTenantSettingsPrefetchStarted=!1;r.loadTenantSettings()},!0))},r}();t.TenantSettingsClient=r})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i;(function(i){i.userConfigsAjaxBound=n.Service.Midgard.userConfigsAjaxBound;var r=function(){function r(t,r){var u=this;this.onAjaxLoad=function(){var t=n.context,i=t.tenantId,r=t.aadUserId,f=t.isCheckingTenantIdOnAjaxEnabled;f&&(i!==(u.cachedUserConfigs&&u.cachedUserConfigs.tenant&&u.cachedUserConfigs.tenant.id)||r!==(u.cachedUserConfigs&&u.cachedUserConfigs.user&&u.cachedUserConfigs.user.id))&&(n.isUserConfigsPrefetchStarted=!1,u.loadUserConfigs());u.broadcastImpl()};this.config=t;this.userConfigsApiUrl=""+t.apiUriBase+t.userConfigsApiUri;this.cachedRequest=r;this.cvid=typeof _G!="undefined"?_G.IG:undefined;i.userConfigsAjaxBound||(sj_evt.bind("ajax.load",this.onAjaxLoad,!0,null,!0),i.userConfigsAjaxBound=!0)}return r.prototype.loadUserConfigs=function(){var t=this,i={onSuccess:function(i,r){i&&t.broadcast(i,r)},onError:function(t,i,r){sj_evt.fire("bfbUserConfigsFailed",t,i,r,n.getFailedEventDetails(t,i))}};sj_evt.fire("bfbUserConfigsStarted",n.getStartedEventDetails());this.getUserConfigs(i);n.isUserConfigsPrefetchStarted=!0},r.prototype.getUserConfigs=function(n){var i={},r;this.cvid!==undefined&&(i.cvid=this.cvid);r=t.addArgsToUrl(this.config,this.userConfigsApiUrl,i);t.sendPostRequest(r,this.cachedRequest,n,this.config.userConfigsTimeout)},r.prototype.broadcast=function(n,t){this.cachedUserConfigs=n;this.broadcastImpl(!1,t)},r.prototype.getCachedUserConfigs=function(){return this.cachedUserConfigs},r.prototype.broadcastImpl=function(t,i){t===void 0&&(t=!0);this.cachedUserConfigs&&sj_evt.fire("bfbUserConfigs",this.cachedUserConfigs,this.cachedRequest,i,t,n.getSucceededEventDetails(this.cachedUserConfigs,i,t))},r}();i.UserConfigsClient=r})(i=t.Midgard||(t.Midgard={}))})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function f(i){var r,f,e;i&&i.length===5&&(r=i[1],t.vNextController==null&&(f=i[2],e=i[4],t.vNextController=new u(r,f,i[3]),f.useClientEngine&&!r.isUpsell?(sj_evt.bind("aad:signedin",function(){return t.vNextController.startWhenReady(!0)},!0,null,!1),sj_evt.bind("aad:signinfailed",function(){t.vNextController.startWhenReady(!1,!0)},!0,null,!1),e&&t.vNextController.startWhenReady()):t.vNextController.startWhenReady()))}function e(i){if(i&&i.length===5&&t.vNextController==null){var r=i[2],f=i[1],e=i[4];t.vNextController=new u(f,r,i[3]);e?sj_evt.bind("COMP_VS_READY",function(){return t.vNextController.startWhenReady(!0)},!0,null,!1):r.useClientEngine&&!f.isUpsell?sj_evt.bind("aad:signedin",function(){return t.vNextController.startWhenReady(!0)},!0,null,!1):t.vNextController.startWhenReady()}}var i=48,r=[t.NotificationKind.SignInFooterUpsell,t.NotificationKind.OverlaySignInUpsell,t.NotificationKind.AnaheimFooterUpsell,t.NotificationKind.SsoSucceeded],u=function(){function u(i,r,u){this.loggedMainNotificationActions=[];this.isAjaxRequery=!1;this.bnpEventFired=!1;this.useReferencedLogo=!0;this.bfbTenantSettingsEventFired=!1;this.options=i;this.cfg=r;this.notification=u;this.userDataVNextClient=new n.Service.UserDataVNextClient(this.options.userData,this.options.mtConfig);this.cfg.useClientEngine&&(this.localUserDataClient=new n.Service.LocalUserDataClient,this.clientNotificationEngine=new t.ClientNotificationEngine(r,this.localUserDataClient,this.options));this.source=this.options.placement===0&&"UNHP"||this.options.placement===1&&"UNSP"||null;this.bindPageEventBeforeStart=this.bindPageEventBeforeStart.bind(this);this.startWhenReadyInternal=this.startWhenReadyInternal.bind(this);this.yieldAndStart=this.yieldAndStart.bind(this);this.checkForTenantSettings=this.checkForTenantSettings.bind(this);this.fetchTenantSettings=this.fetchTenantSettings.bind(this);this.applyTenantSettingsAndStart=this.applyTenantSettingsAndStart.bind(this);this.start=this.start.bind(this);this.isTargetReady=this.isTargetReady.bind(this);this.getTargetDimensions=this.getTargetDimensions.bind(this);this.showInternal=this.showInternal.bind(this);this.onShown=this.onShown.bind(this);this.hide=this.hide.bind(this);this.onDismiss=this.onDismiss.bind(this);this.instClick=this.instClick.bind(this);this.onWindowResize=this.onWindowResize.bind(this);this.logNotificationAction=this.logNotificationAction.bind(this);this.renderState=0}return u.prototype.startWhenReady=function(t,i){var u,r;if(this.renderState==0){if(this.renderState=1,i&&(this.source="SSOFAIL"),this.cfg.useClientEngine){u=sj_cook.get("BFBUSR","BAWAS");bfbTel.logValue(n.EventScope.BingAtWork,"AS",u);r=u==="1";this.cfg.refGlm&&t&&r&&this.options.placement===1&&this.isAjaxRequery&&n.poll({condition:function(){var n=_ge("bw-glm");return n&&(!!n.getElementsByClassName("chevronDown")[0]||!!n.getElementsByClassName("bw-glmList")[0])},callback:function(){},maxAttempts:5,baseIntervalInMillis:50,logName:"UserNotificationController.bfbSsoRef",timeOutCallback:function(){var t="bfbSsoR";_w.location.href.indexOf(t)<0&&(bfbTel.logValue(n.EventScope.UserNotification,"GLMRF","1"),_w.location.href=_w.location.href+"&"+t)}});var f=this.clientNotificationEngine.decide(t,r,this.options.hasMsa,this.options.isUpsell||i),e=f.shown,o=f.suppressed;this.notification=e;this.options.supNotifyKinds=o.map(function(n){return n.notifyKind})}this.bindPageEventBeforeStart();this.startWhenReadyInternal()}},u.prototype.bindPageEventBeforeStart=function(n){var t=this;sj_evt.bind("bfbNotificationShown",function(n){return t.onShown(n&&n[1],n&&n[2],!0,n&&n[3])},!0,null,!0);sj_evt.bind("bfbNotificationDismiss",function(n){return t.onDismiss(n&&n[1],n&&n[2])},!0,null,!0);n||sj_evt.bind("ajax.load",function(){t.bindPageEventBeforeStart(!0);t.clearLoggedAction()},!0,null,!0)},u.prototype.startWhenReadyInternal=function(){var i=this,r;if(this.logSuppressions(),r=this.notification&&this.notification.notifyKind,r==null||r===t.NotificationKind.None){this.renderState=7;return}this.bindToPageEvents();sj_evt.bind("onBnpRender",function(){i.bnpEventFired=!0;i.yieldAndStart()},!0,null,!0);this.options.placement===1&&sj_evt.bind("onPP",this.yieldAndStart,!0,null,!0);sj_evt.bind("ajax.load",function(){i.isAjaxRequery=!0;i.hide(!1,!0)},!0,null,!0);this.cfg.timeoutInMs>=0&&(this.readyTimer=sb_st(function(){i.renderState===2&&(i.renderState=5,bfbTel.logValue(n.EventScope.UserNotification,"Timed out","",{RM:i.notification&&i.notification.renderMode}))},this.cfg.timeoutInMs));sb_st(function(){i.bnpEventFired||bfbTel.logValue(n.EventScope.UserNotification,"onBnpRender awaited","",{PMT:i.options.placement})},3e3)},u.prototype.bindToPageEvents=function(){var i=this,r,t;switch(this.options.placement){case 0:sj_be(_w,"resize",this.onWindowResize);r=_ge("hp_scroll")||_ge("scroll_cont");r&&sj_be(r,"scroll",this.onWindowResize);break;case 1:sj_be(_w,"resize",this.onWindowResize);sj_be(_w,"scroll",this.onSerpScroll)}t=function(){(i.loggedMainNotificationActions==null||i.loggedMainNotificationActions.length===0)&&i.logNotificationAction(3)};sj_be(_w,"beforeunload",t);sj_evt.bind("unload",t);sj_evt.bind("threshold.pageUnload",t)},u.prototype.logSuppressions=function(){this.options.supNotifyKinds&&this.options.supNotifyKinds.length>0&&this.userDataVNextClient.notificationActionBatch(this.options.supNotifyKinds.map(function(n){return{notification:n,action:3,domain:undefined}}))},u.prototype.onWindowResize=function(){(this.renderState===3||this.renderState===4)&&this.notification.renderMode===0&&this.tryToShow(!0)},u.prototype.onSerpScroll=function(){var n=_d.documentElement.scrollHeight-_w.innerHeight-i,t=_w.pageYOffset,r=_ge("bw-un-vnext-footer"),u=_ge("bw-un-vnext-anaFooter"),f=_ge("bw-un-vnext-anaFooterNol");r!=null?r.style.bottom=t>=n?i+"px":"0px":u!=null?u.style.bottom=t>=n?i+"px":"0px":f!=null&&(f.style.bottom=t>=n?i+"px":"0px")},u.prototype.yieldAndStart=function(){if(this.cfg.forced||!this.cfg.yield||this.notification.renderAgg)this.checkForTenantSettings();else if(this.options.placement==1&&this.notification.notifyKind!==t.NotificationKind.SsoSucceeded){if(this.options.hasBnpNotificationOnSerp){this.logNotificationAction(3);bfbTel.logValue(n.EventScope.UserNotification,"Yielded",this.notification&&this.notification.notifyKind,{RM:this.notification&&this.notification.renderMode});return}this.checkForTenantSettings()}else{if(["thp_notf_div","bnp_atop","bnp_ttc","b_notificationContainer"].some(function(n){return _ge(n)!=null})||_d.getElementsByClassName("bubblePlaceholder").length>0||_ge("caro_sunset")!=null){this.logNotificationAction(3);bfbTel.logValue(n.EventScope.UserNotification,"Yielded","",{RM:this.notification&&this.notification.renderMode});return}this.checkForTenantSettings()}},u.prototype.checkForTenantSettings=function(){var i=this;if(!this.options.loadTntCfg&&this.notification.notifyKind!=t.NotificationKind.SsoSucceeded||this.options.placement==0){this.useReferencedLogo=!0;this.notification.queries=this.options.expQries;this.notification.showUserInfo?this.fetchUserInfo():this.start();return}this.options.placement==1?(sj_evt.bind("bfbTenantSettings",function(n){i.applyTenantSettingsAndStart(n&&n[1],!0)},!0,null,!0),sb_st(function(){i.bfbTenantSettingsEventFired||(bfbTel.logValue(n.EventScope.UserNotification,"PageEvent.TenantSettings awaited","",{PMT:i.options.placement}),sj_evt.unbind("bfbTenantSettings",i.applyTenantSettingsAndStart),i.fetchTenantSettings())},200)):this.fetchTenantSettings()},u.prototype.fetchUserInfo=function(){var t=this,i=new n.Service.UserInfoClient(this.options.mtConfig),r={onSuccess:function(i){t.applyUserInfoAndStart(i)},onError:function(i){t.start()}};i.getUserInfo(r)},u.prototype.fetchTenantSettings=function(){var t=this,i=new n.Service.TenantSettingsClient(this.options.mtConfig),r={onSuccess:function(i){t.applyTenantSettingsAndStart(i)},onError:function(i){t.start()}};sb_st(function(){return i.getTenantSettings(r)},1)},u.prototype.applyTenantSettingsAndStart=function(t,i){t&&(i&&(this.bfbTenantSettingsEventFired=!0),this.options.theme=t.theme||this.options.theme,this.options.tenantName=t.tenantDisplayName||this.options.tenantName,this.options.themeColors=t.themeColors||this.options.themeColors,t.iconLarge&&(this.options.tenantLogoSrc=t.iconLarge,this.useReferencedLogo=!1),t.exploreQueries&&t.exploreQueries.length>0&&(this.notification.queries=t.exploreQueries));this.notification.showUserInfo?this.fetchUserInfo():this.start()},u.prototype.applyUserInfoAndStart=function(t){t&&(this.options.userEmailId=t.userPrincipalName||this.options.userEmailId,this.options.userProfilePhotoUrl=this.options.mtConfig.apiUriBase+this.options.mtConfig.profilePhotoApiUri.replace("{0}",t.id),this.options.emailIdNameTruncationCount=this.options.mtConfig.emailIdNameTruncationCount,this.options.emailIdCompanyNameTruncationCount=this.options.mtConfig.emailIdCompanyNameTruncationCount,this.options.tenantNameTruncationCount=this.options.mtConfig.tenantNameTruncationCount);this.start()},u.prototype.start=function(){if(this.notification==null){this.renderState=7;return}if(clearTimeout(this.readyTimer),this.renderState===1){if(this.notification.useExpQries&&(!this.notification.queries||this.notification.queries.length==0)&&this.notification.notifyKind!==t.NotificationKind.SsoSucceeded){bfbTel.logDiag("No explore queries - dropped notification",{PMT:this.options.placement,UNT:this.notification.notifyKind,RM:this.notification.renderMode});return}if(this.renderState=2,this.element==null){if(this.notification.renderMode===1)return;if(this.element=this.notification.notifyKind==t.NotificationKind.OverlaySignInUpsell?t.createPopupForSignInUpsell(this.notification,this.options.tenantName,this.options.hasMsa,this.options.upsellSwoopImageUrl,this.options.upsellSharepointImageUrl,this.options.upsellAvatarImageUrl,this.options.upsellWordImageUrl,this.options.upsellPowerPointImageUrl,this.options.upsellAvatar1ImageUrl,this.options.upsellExcelImageUrl):this.options.mtConfig.isMobile?t.createPopupForMob(this.notification,this.options.placement,this.options.theme,this.options.privacyLink,n.strFormat(this.options.signOutLinkFmt,_w.location.href),this.options.tenantLogoSrc,this.useReferencedLogo,this.options.workQueryUrlFmt,this.options.tenantName,this.options.userEmailId,this.options.userProfilePhotoUrl,this.options.emailIdNameTruncationCount,this.options.emailIdCompanyNameTruncationCount,this.options.tenantNameTruncationCount):this.notification.notifyKind==t.NotificationKind.SignInFooterUpsell?t.createSignInFooterUpsell(this.notification,this.options.tenantName,this.options.hasMsa,this.options.upsellImageUrl):this.notification.notifyKind!=t.NotificationKind.AnaheimFooterUpsell||this.isEdgeUserAgent()?this.notification.notifyKind==t.NotificationKind.RewardsFRENotification?t.createRewardsFRENotification&&t.createRewardsFRENotification(this.notification,this.options.rewardsBannerUrl,this.options.microsoftImageUrl):t.createPopup(this.notification,this.options.placement,this.options.theme,this.options.themeColors,this.options.privacyLink,n.strFormat(this.options.signOutLinkFmt,_w.location.href),this.options.tenantLogoSrc,this.useReferencedLogo,this.options.workQueryUrlFmt,this.options.tenantName):t.createAnaheimFooterUpsell(this.notification,this.options.upsellAnaheimImageUrl,this.options.mtConfig.flights.indexOf("bfbanaupnol")<0,this.options.mtConfig.flights.indexOf("bfbanaupr")>=0,this.options.tenantName),this.element==null){this.cancel();return}_d.body.appendChild(this.element);this.attachEventHandlers()}this.tryToShow()}},u.prototype.isEdgeUserAgent=function(){return window.navigator.userAgent.indexOf("Edge/")>=0||window.navigator.userAgent.indexOf("Edg/")>=0},u.prototype.tryToShow=function(t){var i=this;if(this.cfg.minWinWidth&&_w.innerWidth<this.cfg.minWinWidth&&!this.notification.renderAgg&&r.indexOf(this.notification.notifyKind)==-1){this.hide();return}t?this.showInternal():sb_st(function(){return n.poll({condition:i.isTargetReady,maxAttempts:i.cfg.timeoutInMs>0?20:200,baseIntervalInMillis:50,logName:"UserNotificationController.tryToShow",callback:i.showInternal})},this.cfg.showDelayInMs)},u.prototype.hide=function(t,i){if(this.element)if(i,this.element.style.display="none",t)this.onDismiss(this.notification.notifyKind);else this.renderState=4},u.prototype.onDismiss=function(n,t){this.renderState=6;var i=t||{},r=i.notificationDomain,u=i.notificationCampaign;bfbTel.logDiag("Received NotificationEvent",{eventId:"NotificationEventReceived",notificationAction:2,notificationKind:n,notificationDomain:r,notificationCampaign:u});this.logNotificationAction(2,n,t)},u.prototype.cancel=function(){this.renderState=5;this.logNotificationAction(3)},u.prototype.isTargetReady=function(){return(this.getTargetDimensions()!=null||this.notification.notifyKind==t.NotificationKind.SignInFooterUpsell||this.notification.notifyKind==t.NotificationKind.AnaheimFooterUpsell)&&this.renderState!==5},u.prototype.getTargetDimensions=function(){var i=_ge(this.notification.targetElementId),t;return i==null?null:(t=i.getBoundingClientRect(),t==null||t.top===0&&t.right===0&&t.bottom===0&&t.left===0)?null:t},u.prototype.showInternal=function(){var o,i,s,l;if(this.notification.notifyKind!=t.NotificationKind.SignInFooterUpsell&&this.notification.notifyKind!=t.NotificationKind.AnaheimFooterUpsell){if(o=_w.innerWidth,i=this.getTargetDimensions(),i==null)return;var u,h=void 0,c=void 0,f=void 0,e=void 0,r=this.notification;switch(this.notification.alignment){case 1:u=i.bottom;f=i.left;break;case 2:u=i.bottom;h=o-i.right;break;case 3:u=i.top;f=i.right;break;case 4:u=i.bottom;e=r?i.right+r.popupWidth+r.popupPadding+r.popupOffset:0;e>o?f=i.right-(e-o):(e=0,f=i.right);break;case 5:c=0;break;default:return}this.notification.alignment===4&&(s=_ge("b_op_flyout"),s&&s.className.indexOf("b_op_actv")>0&&(s.className=s.className.replace("b_op_actv","")));this.element.style.top=u==null?null:u+"px";this.element.style.right=h==null?null:h+"px";this.element.style.bottom=c==null?null:c+"px";this.element.style.left=f==null?null:f+"px";this.element.style.display="block";this.element.classList.remove("b_hide");this.element.getElementsByClassName("bw-unArwTop bw-unArwAcctRt").length>0&&r&&(l=this.element.getElementsByClassName("bw-unArwTop bw-unArwAcctRt")[0],l.style.right=e!=0?r.popupArrowOffset-(e-o)+"px":r.popupArrowOffset+"px")}this.onShown(this.notification.notifyKind)},u.prototype.onShown=function(i,u,f,e){f===void 0&&(f=!1);this.renderState=3;var h=e||{},o=h.notificationDomain,s=h.notificationCampaign;bfbTel.logDiag("Received NotificationEvent",{eventId:"NotificationEventReceived",notificationAction:0,notificationKind:i,notificationDomain:o,notificationCampaign:s});this.alreadyLoggedAction(i,0,o,s)?bfbTel.logDiag("Duplicate Notification event",{eventId:"NotificationEventIgnored",notificationAction:0,notificationKind:i,notificationDomain:o,notificationCampaign:s}):(this.logNotificationAction(0,i,e),i&&r.indexOf(i)>-1&&bfbTel.logShown(n.EventScope.UserNotification,this.notification.notifyKind,u||this.source,{RM:this.notification.renderMode,eventId:"Notification_Impression",notificationKind:t.NotificationKind[this.notification.notifyKind]}),f||sj_evt.fire("bfbNotificationShown",null,this.notification.notifyKind))},u.prototype.attachEventHandlers=function(){var n=this,r=this.element.getElementsByClassName("bw-unDis")[0],i,t;sj_be(r,"click",function(){return n.hide(!0)});sj_be(r,"mousedown",function(){return n.instClick("DIS")});i=this.element.getElementsByClassName("bw-unActs")[0];i&&this.notification.actionBtns.forEach(function(t){var u=i.getElementsByClassName("bw-unActBtn"+t.target)[0],r;sj_be(u,"mousedown",function(){return n.instClick(t.target)});r=null;switch(t.target){case"GOTIT":r=function(){return n.hide(!0)};break;case"SIGNOUT":r=function(){return _ge("bw-unSnOtFrm").submit()};break;case"SIGNIN":case"SWITCHACCOUNTS":r=function(){return sj_cook.set("SRCHUSR","POEX","O",!0,"/")}}r&&sj_be(u,"click",r)});t=this.element.getElementsByClassName("bw-expQryLnk");t&&t.length>0&&Array.prototype.forEach.call(t,function(t,i){sj_be(t,"mousedown",function(){return n.instClick("QRY",{I:i++})})})},u.prototype.logNotificationAction=function(n,t,i){var f=t?t:this.notification.notifyKind,e=i||{},r=e.notificationDomain,u=e.notificationCampaign;if(n!==2){if(this.alreadyLoggedAction(t,n,r,u)){bfbTel.logDiag("Duplicate Notification event",{eventId:"NotificationEventIgnored",notificationAction:n,notificationKind:t,notificationDomain:r,notificationCampaign:u});return}this.loggedMainNotificationActions.push({userNotificationKind:t,userNotificationActionKind:n,userNotificationDomain:r,userNotificationCampaign:u})}this.cfg.useClientEngine?this.localUserDataClient.logNotificationAction(f,n):this.userDataVNextClient.notificationAction({notification:f,action:n,domain:r,campaign:u})},u.prototype.alreadyLoggedAction=function(n,t,i,r){if(n==null&&(n=this.notification&&this.notification.notifyKind),this.loggedMainNotificationActions)for(var u in this.loggedMainNotificationActions)if(this.loggedMainNotificationActions[u].userNotificationKind==n&&this.loggedMainNotificationActions[u].userNotificationActionKind==t&&this.loggedMainNotificationActions[u].userNotificationDomain==i&&this.loggedMainNotificationActions[u].userNotificationCampaign==r)return!0;return!1},u.prototype.clearLoggedAction=function(){this.loggedMainNotificationActions.splice(0,this.loggedMainNotificationActions.length)},u.prototype.instClick=function(i,u){if(u==null&&(u={}),u.UNT=this.notification.notifyKind,u.RM=this.notification.renderMode,i==="SIGNOUT")bfbTel.logSignout(n.EventScope.UserNotification,i,this.source,u);else{var f=this.notification&&this.notification.notifyKind;f&&r.indexOf(f)>-1&&(u.eventId=i==="DIS"?"Notification_Dismiss_Click":"Notification_Engagement_Click",u.notificationKind=t.NotificationKind[f]);bfbTel.logClicked(n.EventScope.UserNotification,!1,i,this.source,u)}},u}();t.UserNotificationVNextController=u;t.userNotificationVNextEntry=f;t.userNotificationVNextEntryEhp=e;sj_evt.bind("bfbUserNotificationExists",f,!0,null,!0);sj_evt.bind("bfbUserNotificationExistsEhp",e,!0,null,!0)})(t=n.UserNotification||(n.UserNotification={}))}(BingAtWork||(BingAtWork={}));0