var __spreadArrays=this&&this.__spreadArrays||function(){for(var i=0,n=0,r=arguments.length;n<r;n++)i+=arguments[n].length;for(var u=Array(i),f=0,n=0;n<r;n++)for(var e=arguments[n],t=0,o=e.length;t<o;t++,f++)u[f]=e[t];return u},__assign,BingAtWork;(function(n){function r(t){n.writeSessionStorage("BingAtWorkConversationId",t)}var i=function(){function i(){this.signoutEvtHandlerAdded=!1;this.signoutRetentionNotification="SignoutRetention";this.uidRequestSent=!1;this.dwell={};this.dwellOnUnload=this.dwellOnUnload.bind(this)}return i.init=function(n){typeof bfbTel!="undefined"&&bfbTel.initialized||n!=null&&!n.isMtr&&n.cfg!=null&&n.cfg.e&&n.cfg.env!=="TEST"&&(bfbTel.setContext(n),bfbTel.regLogPagePerf(),bfbTel.regTenantSettingsUpdate(),sj_evt.fire("bfbWebTelemetryInitReady"))},i.prototype.setContext=function(i){var r=this,u,e,f;this.ctx=i;this.initialized||(this.initialized=!0,this.ariaLogger=AriaTelemetry.getLogger(i.cfg.t),n.context&&(this.logicalId=n.context.logicalId),sj_evt.bind("beforeunload",function(){return r.ariaLogger.flushAndTeardown()}),sj_evt.bind("ajax.load",function(){r.logicalId===n.context.logicalId?(r.logicalId=n.generateGuid(),n.context&&(n.context.logicalId=r.logicalId)):r.logicalId=n.context.logicalId}));u=this.ctx.isHomepage;sj_evt.bind("bfbWebTelemetryInitReady",function(){var i={};i.alreadySignedIn=n.context&&!!n.context.isAadAuthenticatedAtServer;i.ssoSignedIn=n.context&&!!n.context.isAadAuthenticatedBySSO;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",i)},!0,null,!0);sj_evt.bind("aad:signedin",function(i){var e,f={},o=(e=i[1])===null||e===void 0?void 0:e.userObjectId;n.context&&(f.alreadySignedIn=!!n.context.isAadAuthenticatedAtServer,n.context.isAadAuthenticatedBySSO=r.lastSSOAttempt!==null,f.ssoSignedIn=n.context.isAadAuthenticatedBySSO);o&&(r.ctx.uid=o,n.context&&(n.context.aadUserId=o));f.latency=r.lastSSOAttempt!==null?(performance.now()-r.lastSSOAttempt).toFixed(2):"-1";r.lastSSOAttempt=null;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"SignedIn_Events",f)},!0,null,!0);sj_evt.bind("aad:signedout",function(){var i={};n.context&&(n.context.isAadAuthenticatedBySSO=!1);i.latency=r.lastSSOAttempt!==null?(performance.now()-r.lastSSOAttempt).toFixed(2):"-1";r.lastSSOAttempt=null;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"SsoError_Events",i)},!0,null,!0);sj_evt.bind("aad:ssoattempt",function(){r.lastSSOAttempt=performance.now()},!0,null,!0);sj_evt.bind("msb:warmupsucceeded",function(){var n={};n.latency=r.lastMsbWarmUpAttempt!==null?(performance.now()-r.lastMsbWarmUpAttempt).toFixed(2):"-1";n.success="1";r.lastMsbWarmUpAttempt=null;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"MsbWarmup_Events",n)},!0,null,!0);sj_evt.bind("msb:warmupfailed",function(){var n={};n.latency=r.lastMsbWarmUpAttempt!==null?(performance.now()-r.lastMsbWarmUpAttempt).toFixed(2):"-1";n.success="0";r.lastMsbWarmUpAttempt=null;r.log(u?t.BingAtWorkHomepage:t.BingAtWork,"MsbWarmup_Events",n)},!0,null,!0);sj_evt.bind("msb:warmupattempt",function(){r.lastMsbWarmUpAttempt=performance.now()},!0,null,!0);sj_evt.bind("ajax.unload",function(){r.dwellOnUnload("A")});_w.addEventListener("beforeunload",function(){r.dwellOnUnload("W")});e=function(){r.logSignout(u?t.BingAtWorkHomepage:t.BingAtWork)};f=function(){n.poll({condition:function(){var t=_ge("postLink");return!r.signoutEvtHandlerAdded&&t&&(sj_be(t,"click",e),r.signoutEvtHandlerAdded=!0),r.signoutEvtHandlerAdded},maxAttempts:50,baseIntervalInMillis:100,logName:"SignoutButton:polling"})};sj_be(_ge("id_n"),"click",f);sj_be(_ge("id_p"),"click",f);sj_evt.bind("Identity.SignoutNotifShown",function(){r.logShown(n.EventScope.UserNotification,0,null,{eventId:"Notification_Impression",notificationKind:r.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifSignoutClick",function(){r.logClicked(n.EventScope.UserNotification,!1,null,null,{eventId:"Notification_Dismiss_Click",notificationKind:r.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifBackgroundClick",function(){r.logClicked(n.EventScope.UserNotification,!1,null,null,{eventId:"Notification_Hide_BackgroundClick",notificationKind:r.signoutRetentionNotification})});sj_evt.bind("Identity.SignoutNotifCancelClick",function(){r.logClicked(n.EventScope.UserNotification,!1,null,null,{eventId:"Notification_Engagement_Click",notificationKind:r.signoutRetentionNotification})})},i.prototype.logShown=function(n,t,i,r){var u,f;t!=null&&(r=r||{},r.T=String(t));i!=null&&(r=r||{},r.S=i);f=(u=this.ctx)===null||u===void 0?void 0:u.canvas;f!=null&&(r=r||{},r.canvas=f);this.log(n,"Shown_Events",r)},i.prototype.logRanking=function(n,i,r,u){var f=n||{placement:null,treatment:null,rankingRuleId:null,legend:null},e=f.placement,o=f.treatment,s=f.rankingRuleId,h=f.legend,c={P:e,T:o,R:s,L:h,MTHD:i,AUD:r==null?null:r?1:0,ERR:u?"UNEXPCTRL":null};this.log(t.BingAtWork,"Ranking_Events",c)},i.prototype.logQuery=function(n,i){var r;if(n){var u=n.encryptedQuery,f=n.queryCount,e=n.queryFrequency,o=n.bhvr,s=n.webIntentConf,h=n.ssp,c=n.intent,l=n.groupId;r={QRY:u,CNT:f,FRQ:e,BHVR:o,CONF:s,SSP:h,INT:c,GID:l}}else r={NWK:1,QID:i};this.log(t.BingAtWork,"Query_Events",r)},i.prototype.logClicked=function(n,r,u,f,e){var o,s,h;u!=null&&(e=e||{},e.T=u);f!=null&&(e=e||{},e.S=f);s=(o=this.ctx)===null||o===void 0?void 0:o.canvas;s!=null&&(e=e||{},e.canvas=s);this.log(n,"Clicked_Events",e);this.ctx&&this.ctx.sci&&(r?this.sendExternalClickRateInst():this.inst(i.instClickEventType,"BfbClick",{BFB_EXT:r?"1":"0",BFB_T:u,BFB_S:f,BFB_SC:t[n]}));h={scope:n,target:u,source:f,properties:e};sj_evt.fire("BingAtWork:Click",h)},i.prototype.logValue=function(n,t,i,r){r=r||{};r.N=t;r.V=i;this.log(n,"Value_Events",r)},i.prototype.logSignout=function(n,t,i,r){var u,f;this.logClicked(n,!1,t,i,r);((u=this.ctx)===null||u===void 0?void 0:u.canvas)&&(r=r||{},r.canvas=(f=this.ctx)===null||f===void 0?void 0:f.canvas);this.log(n,"SignedOut_Events",r)},i.prototype.logRtt=function(n,t,i,r){var u=this.getRequestRtt(i,r);if(!(u.getCall<0)&&!(u.startCall<0)){var f=u==null?"NOPERF":u.getCall.toFixed(2),e=u==null?"NOPERF":u.startCall.toFixed(2),o={N:t,V:f,ST:e};this.log(n,"Rtt_Events",o)}},i.prototype.logSerpLinkClick=function(n,i){var r={T:"SERP",DOM:n,SERPID:i};this.log(t.Serp,"Clicked_Events",r)},i.prototype.logDiag=function(n,i){i=i||{};i.MSG=n;this.log(t.Diag,"Diag_Events",i)},i.prototype.regLogPagePerf=function(){var i=this,t;performance!=null&&performance.getEntries!=null&&(t=function(){i.logPagePerf();sj_evt.unbind("onP1",t)},sj_evt.bind("onP1",t,!0,0,!1))},i.prototype.logPagePerf=function(){for(var n,f,e,r=0,u=performance.getEntries();r<u.length;r++){n=u[r];for(f in i.pagePerfMatchConfig)i.pagePerfMatchConfig[f](n)&&(e={N:f,P:n.name,ET:n.entryType,IT:n.initiatorType,FETCH_S:n.fetchStart,REQ_S:n.requestStart,RES_S:n.responseStart,RES_E:n.responseEnd,D:n.duration,TSZ:n.transferSize},this.log(t.BingAtWork,"Perf_Events",e))}},i.prototype.log=function(t,i,r,u){var f=this;this.ariaLogger!=null&&(r=r||{},!this.ctx.uid&&(n.context===null||n.context===void 0?void 0:n.context.authorized)?(this.uidRequestSent||(this.uidRequestSent=!0,n.sendAjax({url:n.getFetchUidUrl(),onSuccess:function(t){f.ctx.uid=t&&t.uid;f.uidRequestSent=!1},onError:function(t,i){f.uidRequestSent=!1}})),n.poll({condition:function(){return f.ctx.uid!=null},maxAttempts:50,baseIntervalInMillis:50,logName:"WebTelemetry.log:polling",callback:function(){return f.logInternal(t,i,r,u)},timeOutCallback:function(){return f.logInternal(t,i,r,u)}})):this.logInternal(t,i,r,u))},i.prototype.logInternal=function(i,r,u,f){var e={eventType:"Client_Events",name:r||"",properties:{}},o,s,h,c;if(f||this.fillContextualKV(i,u),u!=null)for(o=0,s=Object.getOwnPropertyNames(u);o<s.length;o++)h=s[o],c=u[h],e.properties[h]={value:c!=null?c:""};this.ariaLogger.logEvent(e)},i.prototype.fillContextualKV=function(t,i){var r=this.ctx,e=r.cfg,o=r.uid,s=r.ig,h=r.tid,c=r.sid,l=r.muid,a=r.tn,v=r.tnid,y=r.msa,p=r.mkt,w=r.b,b=r.dev,k=r.os,d=r.osver,g=r.dc,nt=r.snrVersion,f=typeof _G=="undefined"?{IG:s,EventID:h}:_G,u=n.context,tt=u&&u.formCode||"";i.ENV=e.env;i.SC=t;i.IG=f.IG;i.SID=c;i.TID=f.EventID;i.UID=o;i.MUID=l;i.F=tt;i.TN=a;i.TNID=v;i.MSA=y;i.MKT=p;i.B=w;i.deviceType=b;i["DeviceInfo.OsName"]=k;i["DeviceInfo.OsVersion"]=d;i.dataCenter=g;i.clientType="Bing";i.snrVersion=nt;i.logicalSearchId=u&&u.logicalId;i.conversationId=u&&u.conversationId},i.prototype.getRequestRtt=function(t,i){var e=this,f,u,r;return performance==null||performance.getEntries==null?null:(f=performance.getEntries(),u=f.filter(function(r){if(r.name==null)return!1;var u=function(t){var i=r.name.toLowerCase(),u=e.getPathName(i)==="/search";return!u&&n.hasSub(i,t)};return t.every(u)&&(i==null||!i.some(u))}),u.length<1)?{getCall:-1,startCall:-1}:(r=u[0],{getCall:r.duration,startCall:r.fetchStart||r.startTime})},i.prototype.getPathName=function(n){var t=document.createElement("a");return t.href=n,t.pathname},i.prototype.sendExternalClickRateInst=function(){if(typeof _w.si_ct=="function"){var n=_ge("bfb_ExternalLink")||_ge("bfb_InstrumentationLink");n&&_w.si_ct(n)}},i.prototype.instCommand=function(n){this.inst(i.instEventType,"BfbCommand",n)},i.prototype.instAnswerExpansion=function(n){this.inst(i.instEventType,"BfbAnswerExpanded",{V:"1",P:n})},i.prototype.instGleam=function(n){this.inst(i.instEventType,"BfbGleam",{N:n})},i.prototype.instPLT=function(n){this.inst(i.instEventType,"BawPLT",{V:n})},i.prototype.inst=function(t,r,u){for(var o,f=[],e=0,s=Object.getOwnPropertyNames(u);e<s.length;e++)o=s[e],f.push(o),f.push(u[o]||"");Log.Log.apply(Log,__spreadArrays([t,r,i.instEventName,!1],f))},i.prototype.dwellStart=function(i,r){var u=this,f;f={DW_S:Date.now(),S:r};n.poll({condition:function(){return u.ctx!=null},maxAttempts:50,baseIntervalInMillis:50,logName:"WebTelemetry.dwellStart:polling",callback:function(){u.fillContextualKV(i,f);u.dwell[i]=f}})},i.prototype.dwellEnd=function(i){this.logDwell(i);try{delete this.dwell[i]}catch(r){this.dwell[i]=null}},i.prototype.logDwell=function(n,t){var i=this.dwell[n];if(i&&i.DW_S){var u=i.DW_S,r=Date.now(),f=r-u;i.N="DWELL";i.V=f;i.DW_E=r;i.DW_UL=t;this.log(n,"Value_Events",i,!0)}},i.prototype.dwellOnUnload=function(n){for(var i,t=0,r=Object.getOwnPropertyNames(this.dwell);t<r.length;t++)i=r[t],this.dwell.hasOwnProperty(i)&&this.dwell[i]&&this.logDwell(i,n);this.ariaLogger.flush()},i.prototype.regTenantSettingsUpdate=function(){var t=this;sj_evt.bind("bfbTenantSettings",function(i){var r=i[1];t.ctx.tn=r.tenantDisplayName;t.ctx.tnid=t.ctx.tnid||r.tenantObjectId;n.context&&!n.context.tenantId&&(n.context.tenantId=r.tenantObjectId)},!0,null,!0)},i.pagePerfMatchConfig={"RMS:BfbCssBundle":function(n){return n.name.match(/\/rms\/BfbCssBundle\//)},"RMS:BfbPreBundle":function(n){return n.name.match(/\/rms\/BfbPreBundle\//)},"RMS:BfbBundle":function(n){return n.name.match(/\/rms\/BfbBundle\//)},"RMS:BfbDependencies":function(n){return n.name.match(/\/rms\/BfbDependencies\//)}},i.instEventType="ClientInst",i.instClickEventType="DHTMLClick",i.instEventName="BAW",i}(),t;n.WebTelemetry=i,function(n){n[n.Serp=-1]="Serp";n[n.BingAtWork=0]="BingAtWork";n[n.BfbController=1]="BfbController";n[n.Gleam=2]="Gleam";n[n.Upsell=3]="Upsell";n[n.Feedback=4]="Feedback";n[n.Paw=5]="Paw";n[n.SkypeClient=6]="SkypeClient";n[n.Person=7]="Person";n[n.Document=8]="Document";n[n.Bookmark=9]="Bookmark";n[n.Building=10]="Building";n[n.FloorPlan=11]="FloorPlan";n[n.OrgChart=12]="OrgChart";n[n.Group=13]="Group";n[n.RefQna=14]="RefQna";n[n.PowerBi=15]="PowerBi";n[n.BookmarkSuggest=16]="BookmarkSuggest";n[n.ExploreQuery=17]="ExploreQuery";n[n.Carousel=18]="Carousel";n[n.WebResult=19]="WebResult";n[n.PowerApps=20]="PowerApps";n[n.Conversation=21]="Conversation";n[n.EmbeddedController=22]="EmbeddedController";n[n.UserNotification=23]="UserNotification";n[n.SuggestedQueries=24]="SuggestedQueries";n[n.Site=25]="Site";n[n.ExplorePage=26]="ExplorePage";n[n.LandingPage=27]="LandingPage";n[n.Mainline=37]="Mainline";n[n.BingAtWorkHomepage=43]="BingAtWorkHomepage";n[n.BingAtWorkChromeNewTab=44]="BingAtWorkChromeNewTab";n[n.UnconsciousArrivalUpsell=45]="UnconsciousArrivalUpsell";n[n.LowConfidenceGleam=46]="LowConfidenceGleam";n[n.Rewards=47]="Rewards";n[n.RightRail=60]="RightRail";n[n.Diag=999]="Diag";n[n.BingAtWorkNeo=70]="BingAtWorkNeo"}(t=n.EventScope||(n.EventScope={}));n.writeConversationId=r;typeof bfbTel=="undefined"&&(bfbTel=new i,sj_evt.fire("bfbWebTelemetryExists"))})(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){function y(n,t){var i={},r=n.flights,u;r&&r.length>0&&(i.variants=r.join());for(u in t)i[u]=t[u];return i}function p(n,t){var i,r;if(t)for(i in t)r=n.indexOf("?")>-1?"&":"?",n+=""+r+encodeURIComponent(i)+"="+encodeURIComponent(t[i]);return n}function w(n){var t=7;switch(n){case 500:t=6;break;case 404:t=9;break;case 401:t=4;break;case 504:t=5;break;case 400:t=8}return t}function b(n){for(var r,t,f,u=[],i=1;i<arguments.length;i++)u[i-1]=arguments[i];if(!n)return n;for(r=n,t=0;t<u.length;t++)f=new RegExp("\\{"+t+"\\}","gm"),r=r.replace(f,arguments[t+1]);return r}function k(t,i){try{return JSON.parse(t)}catch(r){return null}}function d(n,t,i){var r,u;for(i===void 0&&(i=7),r=n,u=0;r&&u<i;u++){if(r===t)return!0;r=r.parentElement}return!1}function g(n){n!=null&&n.parentNode!=null&&n.parentNode.removeChild(n)}function r(n,t,i,u,f){u===void 0&&(u=0);n()||(t>1?setTimeout(function(){return r(n,t-1,i,u,f)},i+u):f&&f())}function u(n){if(typeof bfbTel!="undefined"&&bfbTel){n();return}sj_evt.bind("bfbWebTelemetryExists",n,!1,null,!0)}function nt(t){if(typeof n.Strings!="undefined"&&n.Strings){t();return}sj_evt.bind("BingAtWork:LocStrings",t,!0,null,!0)}function i(){return!!("localStorage"in _w&&_w.localStorage)}function ut(t,r,u,s,c,l){var a,p,y,b;if(!i()||!ft())return r({onSuccess:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onSuccess.apply(u,t);s.onSuccess.apply(s,t)},onError:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u.onError.apply(u,t);s.onError.apply(s,t)}});if(n._isEventBind||(n._isEventBind=!0,sj_evt.bind("ajax.unload",function(){n._localStorageAutoRefreshHandlersBacklog={};n._localStorageOneOffHandlersBacklog={}},!0,null,!0)),n._localStoragePendingAutoRefreshes=n._localStoragePendingAutoRefreshes||{},n._localStorageAutoRefreshHandlersBacklog=n._localStorageAutoRefreshHandlersBacklog||{},n._localStorageOneOffHandlersBacklog=n._localStorageOneOffHandlersBacklog||{},n._localStorageAutoRefreshHandlersBacklog[t]&&n._localStorageAutoRefreshHandlersBacklog[t].length>0){n._localStorageAutoRefreshHandlersBacklog[t].push(u);return}if(n._localStorageAutoRefreshHandlersBacklog[t]=[u],n._localStorageOneOffHandlersBacklog[t]&&n._localStorageOneOffHandlersBacklog[t].length>0){n._localStorageOneOffHandlersBacklog[t].push(s);return}if(n._localStorageOneOffHandlersBacklog[t]=[s],a=e(t),p=at(a),p){var w=p.split(";",2),k=w[0],d=w[1],v=Number(k);if(!v||v===NaN||v<(new Date).getTime())h(a);else{y=void 0;try{y=JSON.parse(d)}catch(g){h(a)}if(y!=null){o(t,y,new Date(v),!0,l,r,c,!0);return}}}b=f(t,c,l,r);r(b)}function ft(){return n.context&&n.context.isLSCacheEnabled}function f(i,r,u,f){var s=e(i);return{onSuccess:function(n){var t=r(n);o(i,n,t,!1,u,f,r);setTimeout(function(){return lt(s,t.getTime()+";"+JSON.stringify(n))},0)},onError:function(){for(var f=[],r=0;r<arguments.length;r++)f[r]=arguments[r];t(n._localStorageAutoRefreshHandlersBacklog[i],function(n){n.onError&&n.onError.apply(n,f)});t(n._localStorageOneOffHandlersBacklog[i],function(n){n.onError&&n.onError.apply(n,f)});u||(n._localStorageAutoRefreshHandlersBacklog[i]=[]);n._localStorageOneOffHandlersBacklog[i]=[]}}}function e(n){return""+tt+n}function o(i,r,u,e,o,s,h,c){if(t(n._localStorageAutoRefreshHandlersBacklog[i],function(n){n.onSuccess(r,undefined,c)}),o||(n._localStorageAutoRefreshHandlersBacklog[i]=[]),t(n._localStorageOneOffHandlersBacklog[i],function(n){n.onSuccess(r,undefined,c)}),n._localStorageOneOffHandlersBacklog[i]=[],o&&!n._localStoragePendingAutoRefreshes[i]){var l=Math.max(u.getTime()-(new Date).getTime()+it,e?rt:0);n._localStoragePendingAutoRefreshes[i]=!0;setTimeout(function(){var t=f(i,h,o,s);s(t);n._localStoragePendingAutoRefreshes[i]=!1},l)}}function et(t,i){var r,u;return((u=(r=n.SessionStorage)===null||r===void 0?void 0:r.isSupported)===null||u===void 0?void 0:u.call(r))?ot(n.SessionStorage.getItem(t),i):undefined}function ot(n,t){if(!n)return undefined;var r=n.split(";",2),u=r[0],f=r[1],i=Number(u);return!i||i===NaN||i<=(new Date).getTime()-t?undefined:f}function st(t,i){var r,u;((u=(r=n.SessionStorage)===null||r===void 0?void 0:r.isSupported)===null||u===void 0?void 0:u.call(r))&&n.SessionStorage.setItem(t,(new Date).getTime()+";"+i)}function t(n,t){if(n)for(var i=0;i<n.length;i++)t(n[i])}function ht(n,t){if(!n)return!1;for(var i=0;i<n.length;i++)if(n[i]===t)return!0;return!1}function s(){var n=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}function ct(n){var t;return typeof Event=="function"?t=new Event(n):(t=document.createEvent("Event"),t.initEvent(n,!0,!0)),t}function lt(n,t){if(i())try{localStorage.setItem(n,t)}catch(r){}}function at(n){if(i())try{var t=localStorage.getItem(n);return t===null?undefined:t}catch(r){}return undefined}function h(n){if(i())try{localStorage.removeItem(n)}catch(t){}}function c(t){var l=t.condition,a=t.maxAttempts,f=t.baseIntervalInMillis,r=t.logName,o=t.callback,e=t.additionalIntervalPerAttemptInMillis,i=t.currentAttempt,s=t.timeOutCallback,h;e=e||0;i=i||0;l()?o!=null&&o():(i++,i<a?(h=__assign(__assign({},t),{baseIntervalInMillis:f+e,currentAttempt:i}),setTimeout(function(){return c(h)},f)):(u(function(){return bfbTel.logDiag(r+"_TimedOut")}),s!=null&&s()))}function vt(t,i,r,u,f){for(var h,a,y,w,v=[],c=5;c<arguments.length;c++)v[c-5]=arguments[c];h=new Date;n._throttleRecords||(n._throttleRecords={});a=f.id;a||(a=f.id=s());try{y=JSON.stringify(r)}catch(b){return}var p=f.name||"(anonymous)",o=p+"_"+a+"_"+y,e=n._throttleRecords[o];if(e){if(e.totalCalls++,e.clusterCalls++,e.clusterCalls>t)if(w=h.getTime()-e.lastRunTime.getTime(),w>=i)e.clusterCalls=1,e.clusters++;else return e.throttledCalls++,e.lastThrottledCallStack=l("Call throttled"),u(),undefined}else n._throttleRecords[o]={totalCalls:1,clusterCalls:1,allowedCalls:0,throttledCalls:0,firstRunTime:h,lastRunTime:h,clusters:1,name:p};return n._throttleRecords[o].allowedCalls++,n._throttleRecords[o].lastRunTime=h,f.apply(void 0,v)}function l(n){return a(new Error(n).stack)}function a(n){return n&&n.replace(/\?.*/gi,"?<query string redacted>")}function yt(i){if(i===void 0&&(i=!0),!n._throttleRecords)return undefined;var r=[],u=Object.keys(n._throttleRecords);return t(u,function(t){var u=n._throttleRecords[t];(!i||u.throttledCalls>0)&&r.push(u)}),r}function pt(){n._throttleRecords={}}function wt(n,t){if(!n)return undefined;for(var i=0;i<n.length;i++)if(t(n[i]))return n[i];return undefined}function bt(n){return n&&n.length==0}function kt(n){var i=v(n),t;return i?(t=i.slice(0,4),t=="<svg"||t=="<?xm"):!1}function v(t){try{return atob(t)}catch(i){}}function dt(t){typeof n.Localhost!="undefined"&&typeof n.Localhost.augmentMsbMtAjax=="function"&&n.Localhost.augmentMsbMtAjax(t)}function gt(n){if(!n.isOnWorkVertical)return undefined;var t=(window.location.hash||"").replace("#",""),i=t.indexOf("-");return t.substring(0,i>-1?i:t.length).toLocaleLowerCase()||"all"}n.bawSourceName="BingAtWork";n.msPerDay=864e5;n.getRequestMetadata=y;n.mergeArgsIntoUrl=p;n.getError=w;n.strFormat=b;n.tryParseJson=k;n.hasAncestorElement=d;n.removeElement=g;n.retryPoll=r;n.whenWebTelemetryExists=u;n.whenLocStringsAvailable=nt;n.isLocalStorageSupported=i;var tt="MSBLS_",it=18e4,rt=3e4;n.withLocalStorageCache=ut;n.getSessionStorage=et;n.writeSessionStorage=st;n.forEach=t;n.includes=ht;n.generateGuid=s;n.createNewEvent=ct;n.poll=c;n.throttle=vt;n.getSanitizedCallStack=l;n.redactQueryStrings=a;n.getThrottleRecords=yt;n.resetThrottleRecords=pt;n.find=wt;n.isEmpty=bt;n.isImageLikelySvg=kt;n.decodeBase64=v;n.augmentMsbMtAjax=dt;n.getStartedEventDetails=function(){return{startTime:new Date,startTimeStartDuration:performance.now()}};n.getSucceededEventDetails=function(n,t,i){return{endTime:new Date,endTimeStartDuration:performance.now(),response:n,headers:t,status:200,isFromCache:i}};n.getFailedEventDetails=function(n,t){return{endTime:new Date,endTimeStartDuration:performance.now(),error:n,status:t}};n.getLoweredWorkSerpVerticalDomain=gt}(BingAtWork||(BingAtWork={})),function(n){function u(t){if(r){var u=[t.url,t.requestType],f=function(){t.onError&&t.onError(7,0,"throttled")};n.throttle(10,1e4,u,f,i,t)}else i(t)}function i(i){var h,c,l;if(i!=null){var a=i.timeout,v=i.onSuccess,u=i.onError,y=i.accessToken,e=i.url,o=i.body,p=i.tries,k=i.requestType,s=i.headers,d=i.convertPropertiesToPascalCase,r=sj_gx(),w=k||"GET",b=function(){return r.open(w,e,!0)};if(b(),r.withCredentials=!i.disableWithCredentials,r.ontimeout=function(){return u&&u(5,504,null)},r.timeout=a==null?0:a,h=p||1,c=function(t,i,r,f){n.whenWebTelemetryExists(function(){return bfbTel.logDiag(f,{url:e,reason:i})});u!=null&&u(i,t,r)},y!=null&&r.setRequestHeader("Authorization","Bearer "+y),f()&&w==="POST"&&r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),s)for(l in s)r.setRequestHeader(l,s[l]);r.onreadystatechange=function(){var i,u,f,e,s;if(r.readyState===4)if(r.status===200){if(v!=null){if(i=null,u={},r.responseText!=null&&r.responseText!=="")try{i=JSON.parse(r.responseText)}catch(l){c(-1,10,r.responseText,"Bad data");return}if(r.HEADERS_RECEIVED)try{f=r.getAllResponseHeaders();e=f.trim().split(/[\r\n]+/);e.forEach(function(n){var t=n.split(": "),i=t.shift(),r=t.join(": ");u[i]=r})}catch(a){}i=d?t(i):i;v(i,u)}}else--h>0?(r.abort(),b(),r.send(o)):(s=n.getError(r.status),c(r.status,s,r.responseText,"Ajax call failed with status "+r.status+". No retries available."))};r.send(o)}}function t(n){return n===null?null:n===undefined?undefined:typeof n=="number"||typeof n=="string"||typeof n=="boolean"?n:Array.isArray(n)?n.map(t):Object.keys(n).reduce(function(i,r){var u=""+r[0].toUpperCase()+r.slice(1);return i[u]=typeof n[r]=="object"?t(n[r]):n[r],i},{})}function f(){return typeof window=="undefined"||!window.navigator||!window.navigator.userAgent?!1:window.navigator.userAgent.indexOf("PhantomJS")>-1}var r=n.context&&n.context.isThrottlingEnabled;n.sendAjax=u}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function i(t,i,r){var u=n.getRequestMetadata(t,r);return n.mergeArgsIntoUrl(i,u)}function r(t,i,r,u,f,e){var o={url:t,accessToken:e,requestType:"POST",body:JSON.stringify(i),timeout:u,headers:f,onSuccess:r.onSuccess,onError:r.onError};n.augmentMsbMtAjax(o);n.sendAjax(o)}t.addArgsToUrl=i;t.sendPostRequest=r})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},function(n){var t;(function(t){t.tenantSettingsAjaxBound=n.Service.tenantSettingsAjaxBound;var i=(n.context||{isVerticalConfigFromTenantSettings:!1}).isVerticalConfigFromTenantSettings,r=function(){function r(i,r){var u=this;this.config=i;this.onAjaxLoad=function(){var t=n.context,i=t.tenantId,r=t.isCheckingTenantIdOnAjaxEnabled;r&&i!==(u.cachedTenantSettings&&u.cachedTenantSettings.tenantObjectId)&&(n.isTenantSettingsPrefetchStarted=!1,u.loadTenantSettings());u.broadcastImpl()};this.tenantSettingsApiUrl=""+i.apiUriBase+i.tenantSettingsApiUri;this.onResponse=r;t.tenantSettingsAjaxBound||(sj_evt.bind("ajax.load",this.onAjaxLoad,!0,null,!0),t.tenantSettingsAjaxBound=!0)}return r.isValid=function(n){return!!(n&&n.tenantObjectId&&n.tenantDisplayName)},r.prototype.loadTenantSettings=function(){var t=this,i={onSuccess:function(i,r,u){i&&(t.broadcast(i,r,u),t.onResponse&&t.onResponse.onSuccess&&t.onResponse.onSuccess(i,r,u))},onError:function(i,r,u){sj_evt.fire("bfbTenantSettingsFailed",i,r,u,n.getFailedEventDetails(i,r));t.onResponse&&t.onResponse.onError&&t.onResponse.onError(i,r);r===404&&(t.isTenantNotProvisioned=!0)}};this.getTenantSettings(i)},r.prototype.getTenantSettings=function(t){if(!n.isTenantSettingsPrefetchStarted){sj_evt.fire("bfbTenantSettingsStarted",n.getStartedEventDetails());n.isTenantSettingsPrefetchStarted=!0;var u=__assign(__assign({},n.getRequestMetadata(this.config)),{isLokiVerticalConfigRequired:i}),f=n.mergeArgsIntoUrl(this.tenantSettingsApiUrl,u),r={url:f,requestType:"GET",timeout:this.config.tenantSettingsTimeout,onSuccess:t&&t.onSuccess?function(n,i){return t.onSuccess(n.tenantSettings,n.user,i)}:null,onError:t&&t.onError};n.augmentMsbMtAjax(r);n.sendAjax(r)}},r.prototype.broadcast=function(t,i,u){r.isValid(t)&&(this.cachedTenantSettings=t,this.cachedUserInfo=i,this.cachedTenantConfig=this.convertToTenantConfig(t),this.broadcastImpl(!1,u))},r.prototype.convertToJson=function(n){if(!n)return"EmptyJSON";var t=__assign({},n);return delete t.adminEmail,delete t.exploreQueries,delete t.iconLarge,delete t.iconLargeChecksum,JSON.stringify(t)},r.prototype.getCachedTenantSettings=function(){return this.cachedTenantSettings},r.prototype.getIsTenantNotProvisioned=function(){return this.isTenantNotProvisioned},r.prototype.convertToTenantConfig=function(n){var t=n.tenantDisplayName,i=n.iconLarge,r=n.iconLargeChecksum,u=n.theme,f=n.adminEmail,e=n.themeColors;return{displayName:t,theme:u,iconLarge:i,iconLargeChecksum:r,adminEmail:f,themeColors:e}},r.prototype.broadcastImpl=function(t,i){var r=this;t===void 0&&(t=!0);this.cachedTenantSettings&&sj_evt.fire("bfbTenantSettings",this.cachedTenantSettings,this.cachedUserInfo,i,t,n.getSucceededEventDetails(this.cachedTenantSettings,i,t));this.cachedTenantConfig&&sj_evt.fire("bfbtcfg",this.cachedTenantConfig);this.cachedUserInfo&&this.cachedUserInfo.displayName&&this.cachedUserInfo.userPrincipalName?sj_evt.fire("bfbTenantSettingsUserInfo"):this.isUserInfoRetried||(this.isUserInfoRetried=!0,sj_evt.bind("aad:signedin",function(){n.isTenantSettingsPrefetchStarted=!1;r.loadTenantSettings()},!0))},r}();t.TenantSettingsClient=r})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){var i;(function(i){i.userConfigsAjaxBound=n.Service.Midgard.userConfigsAjaxBound;var r=function(){function r(t,r){var u=this;this.onAjaxLoad=function(){var t=n.context,i=t.tenantId,r=t.aadUserId,f=t.isCheckingTenantIdOnAjaxEnabled;f&&(i!==(u.cachedUserConfigs&&u.cachedUserConfigs.tenant&&u.cachedUserConfigs.tenant.id)||r!==(u.cachedUserConfigs&&u.cachedUserConfigs.user&&u.cachedUserConfigs.user.id))&&(n.isUserConfigsPrefetchStarted=!1,u.loadUserConfigs());u.broadcastImpl()};this.config=t;this.userConfigsApiUrl=""+t.apiUriBase+t.userConfigsApiUri;this.cachedRequest=r;this.cvid=typeof _G!="undefined"?_G.IG:undefined;i.userConfigsAjaxBound||(sj_evt.bind("ajax.load",this.onAjaxLoad,!0,null,!0),i.userConfigsAjaxBound=!0)}return r.prototype.loadUserConfigs=function(){var t=this,i={onSuccess:function(i,r){i&&t.broadcast(i,r)},onError:function(t,i,r){sj_evt.fire("bfbUserConfigsFailed",t,i,r,n.getFailedEventDetails(t,i))}};sj_evt.fire("bfbUserConfigsStarted",n.getStartedEventDetails());this.getUserConfigs(i);n.isUserConfigsPrefetchStarted=!0},r.prototype.getUserConfigs=function(n){var i={},r;this.cvid!==undefined&&(i.cvid=this.cvid);r=t.addArgsToUrl(this.config,this.userConfigsApiUrl,i);t.sendPostRequest(r,this.cachedRequest,n,this.config.userConfigsTimeout)},r.prototype.broadcast=function(n,t){this.cachedUserConfigs=n;this.broadcastImpl(!1,t)},r.prototype.getCachedUserConfigs=function(){return this.cachedUserConfigs},r.prototype.broadcastImpl=function(t,i){t===void 0&&(t=!0);this.cachedUserConfigs&&sj_evt.fire("bfbUserConfigs",this.cachedUserConfigs,this.cachedRequest,i,t,n.getSucceededEventDetails(this.cachedUserConfigs,i,t))},r}();i.UserConfigsClient=r})(i=t.Midgard||(t.Midgard={}))})(t=n.Service||(n.Service={}))}(BingAtWork||(BingAtWork={})),function(n){var t="ms-search-popup",i=function(){function i(i,r){var u=this;(this.show=function(){if(!u.element.parentElement){var t=_ge("b_bfb");if(!t)return;t.appendChild(u.element);_d.body.removeEventListener("click",u.hideIfClickedElsewhere);_d.body.addEventListener("click",u.hideIfClickedElsewhere)}u.updatePosition();u.isBoundToPage||(u.isBoundToPage=!0,sj_be(_w,"resize",u.updatePosition));u.element.style.display="block"},this.hide=function(){u.element.style.display="none"},this.getElement=function(){return u.element},this.hideIfClickedElsewhere=function(t){var i=t.target;i===u.targetElement||n.hasAncestorElement(i,u.getElement())||n.hasAncestorElement(i,u.targetElement)||u.hide()},this.render=function(){u.element||(u.element=sj_ce("div"),u.element.className=t,u.element.style.display="none",u.element.appendChild(u.content))},this.updatePosition=function(){var t=u.element.parentElement.getBoundingClientRect(),n=u.targetElement.getBoundingClientRect(),i=t.right-n.right,r=n.top-t.top+n.height;u.element.style.right=i+"px";u.element.style.top=r+"px"},i&&r)&&(this.targetElement=i,this.content=r,this.render())}return i}();n.PopUp=i}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function r(t,i,r,u){var f=sj_ce("img",null,r);return i&&(f.src=i.iconLarge?"data:image/"+(u?"svg+xml":"png")+";base64,"+i.iconLarge:n.strFormat(t.logoUrlFmt,i.iconLargeChecksum),f.title=i.tenantDisplayName,f.setAttribute("aria-label",f.title)),f}function u(t,i,r){var u=sj_ce("a",null,t);return u.target="_self",u.href=i,u.setAttribute("role","button"),u.addEventListener("click",function(){r==!0?bfbTel.logClicked(n.EventScope.Gleam,!1,"UPSL","PGLM"):bfbTel.logClicked(n.EventScope.Gleam,!1,null,"PGLM")}),u}function f(t,i){var r=new n.PopUp(t,i);return t.addEventListener("click",r.show),r}function e(t,i,r){var f=sj_ce("div"),e=t.strings,s=t.learnMoreLinkUrl,o=sj_ce("p"),u;return o.innerText=n.strFormat(e.learnMoreTip,i.tenantDisplayName),f.appendChild(o),u=sj_ce("a"),u.href=s,u.target="_blank",u.innerText=e.learnMoreLinkLabel,u.addEventListener("click",function(n){r(n)}),f.appendChild(u),f}function o(t,i){var e=t.strings,o=t.dismissForDays,s=t.dismissForMaxDays,f=sj_ce("ol"),u=sj_ce("li"),r;return u.innerText=n.strFormat(e.dismissForDays,o),u.addEventListener("click",function(){i(o)}),u.setAttribute("role","button"),r=sj_ce("li"),r.innerText=e.dismissAlways,r.addEventListener("click",function(){i(s)}),r.setAttribute("role","button"),f.appendChild(u),f.appendChild(r),f}function s(n){var t=document.createElementNS(i,"svg");return n&&t.setAttribute("class",n),t}function h(n,t){var r=document.createElementNS(i,"path");return r.setAttribute("d",n),t&&r.setAttribute("fill",t),r}function c(n,t,r,u,f,e,o){var s=document.createElementNS(i,"rect");return s.setAttribute("x",n),s.setAttribute("y",t),s.setAttribute("rx",r),s.setAttribute("width",u),s.setAttribute("height",f),s.setAttribute("fill",e),s.setAttribute("stroke",o),s}t.createTenantLogo=r;t.createSignInButton=u;t.createPopUp=f;t.createLearnMoreInfo=e;t.createDismissButtons=o;var i="http://www.w3.org/2000/svg";t.createSvg=s;t.createSvgPath=h;t.createSvgRect=c})(t=n.Midgard||(n.Midgard={}))}(BingAtWork||(BingAtWork={})),function(n){var t;(function(t){function r(r){if(!t.controller)if(r.length===3){var e=r[0],u=r[1],f=r[2];t.controller=new i(u,f)}else return;t.controller.start()}var i=function(){function t(t,i){var r=this;this.start=function(){r.mtCfg&&(r.tenantSettingsClient||(r.tenantSettingsClient=new n.Service.TenantSettingsClient(r.mtCfg)),r.tenantSettingsClient.getTenantSettings({onSuccess:r.handleTenantSettingsReceived,onError:function(t){}}),sj_evt.bind("bfbTenantSettings",r.onReceiveTenantSettingsFromEvent,!0,null,!0))};this.onReceiveTenantSettingsFromEvent=function(n){r.handleTenantSettingsReceived(n[1],n[2])};this.handleTenantSettingsReceived=function(t,i){n.Service.TenantSettingsClient.isValid(t)&&(sj_evt.unbind("bfbTenantSettings",r.onReceiveTenantSettingsFromEvent),r.tenantSettings=t,r.tenantSettingsClient.broadcast(r.tenantSettings,i))};this.mtCfg=t;this.tenantSettings=i;!t}return t}();t.MsbContentOfflineController=i;sj_evt.bind("bfbMsbContentOfflineExists",r,!0,null,!0);sj_evt.bind("ajax.load",r,!0,null,!0)})(t=n.MsbContentOffline||(n.MsbContentOffline={}))}(BingAtWork||(BingAtWork={}))